T.admin.DatePicker=function(a){this.LAST_DAY=[31,28,31,30,31,30,31,31,30,31,30,31];this.DAY_MS=24*60*60*1000;this.template=null;this.elements={};this.elements.input=a.input;this.elements.button=a.button;this.realDate=a.realDate;daum.Event.addEvent(this.elements.button,"click",this.toggle.bindAsEventListener(this))}.members({open:function(){var a=this.elements.input.value.trim();this.selectedDate=this.isValidate(a)?this.parse(a):null;this.focusDate=this.selectedDate||this.realDate;if(this.elements.layer){daum.Element.show(this.elements.layer);this.render(this.createDataObject())}else{this.render(this.createDataObject(true))}},close:function(a){if(this.elements.layer){daum.Element.hide(this.elements.layer)}},toggle:function(a){a|daum.Event.stopEvent(a);if(this.elements.layer&&daum.Element.visible(this.elements.layer)){this.close()}else{this.open()}},createDataObject:function(j){var f=this.focusDate;var a=this.LAST_DAY[f.getMonth()];var k=new Date(f.getFullYear(),f.getMonth(),1);var c=new Date(f.getFullYear(),f.getMonth(),a);var b=k.getDay()+a-c.getDay()+6;var e=k.getTime()-this.DAY_MS*k.getDay();var g=[];for(var h=0;h<b;++h){g.push(new Date(e));e+=this.DAY_MS}var l={isInit:!!j,dayList:["일","월","화","수","목","금","토"],focus:f,selected:this.selectedDate,dateList:g};if(j){l.yearList=[];for(var h=this.realDate.getFullYear()-12,d=this.realDate.getFullYear()+3;h<=d;++h){l.yearList.push(h)}l.monthList=[1,2,3,4,5,6,7,8,9,10,11,12]}return l},loadTemplate:function(a){new daum.Ajax({url:"/templates/util/datePicker.jst",onsuccess:function(b){this.template=TrimPath.parseTemplate(b.responseText.trim());a()}.bind(this)}).request()},setPosition:function(){if(this.elements.layer&&daum.Element.visible(this.elements.layer)){var b=daum.Element.getCoords(this.elements.button);var e=daum.Element.getCoords(this.elements.layer);var d=e.right-e.left;var c=0;var a=daum.Element.getParent(this.elements.button);while(a!==document.body){c+=a.scrollTop;a=daum.Element.getParent(a)}daum.Element.setPosition(this.elements.layer,b.right-d,b.bottom+3-c)}},render:function(b){if(!this.template){this.loadTemplate(this.render.bind(this,b));return}if(b.isInit){var a=this.elements.layer=daum.createElement(this.template.process(b));document.body.appendChild(a);this.elements.content=daum.$$("div.box_con",a)[0];this.elements.titYear=daum.$$("a.tit_year",a)[0];this.elements.titMonth=daum.$$("a.tit_month",a)[0];this.elements.listYear=daum.$$("ul.list_year",a)[0];this.elements.listMonth=daum.$$("ul.list_month",a)[0];daum.Event.addEvent(document,"click",this.close.bindAsEventListener(this));daum.Event.addEvent(this.elements.layer,"click",this.onClick.bindAsEventListener(this));daum.Element.show(a);this.setPosition()}else{this.elements.content.innerHTML=this.template.process(b);this.elements.titYear.innerHTML=b.focus.getFullYear();this.elements.titMonth.innerHTML=(b.focus.getMonth()+1)}},onClick:function(b){daum.Event.stopEvent(b);var a=daum.Event.getElement(b);if(a.tagName.toLowerCase()!="a"){return}if(daum.Element.hasClassName(a,"btn_today")){this.select(this.realDate.getTime())}else{if(daum.Element.hasClassName(a,"tit_year")){daum.Element.toggle(this.elements.listYear)}else{if(daum.Element.hasClassName(a,"tit_month")){daum.Element.toggle(this.elements.listMonth)}else{if(a.href.indexOf("#item-year-")>-1){this.changeYear(a.href.split("item-year-")[1].toInt())}else{if(a.href.indexOf("#item-month-")>-1){this.changeMonth(a.href.split("#item-month-")[1].toInt())}else{if(a.href.indexOf("#item-date-")>-1){this.select(a.href.split("#item-date-")[1].toInt())}}}}}}},select:function(b){var a=new Date(b);this.elements.input.value=this.format(a);this.close();this.selectCallback(a)},changeYear:function(b){this.elements.titYear.innerHTML=b;daum.Element.hide(this.elements.listYear);var a=new Date();a.setFullYear(b);a.setMonth(this.focusDate.getMonth());a.setDate(1);this.focusDate=a;this.render(this.createDataObject())},changeMonth:function(b){this.elements.titMonth.innerHTML=b;daum.Element.hide(this.elements.listMonth);var a=new Date();a.setFullYear(this.focusDate.getFullYear());a.setDate(1);a.setMonth(b-1);this.focusDate=a;this.render(this.createDataObject())},selectCallback:function(a){},isValidate:function(a){return/^([0-9][0-9][0-9][0-9])\.[0-9]?[0-9]\.([0-9]?[0-9])$/.test(a)},parse:function(c){var a=c.split(".");var b=new Date();b.setFullYear(a[0].toInt());b.setMonth(a[1].toInt()-1);b.setDate(a[2].toInt());return b},format:function(b){var a=b.getFullYear()+".";a+=daum.Number.fillZero((b.getMonth()+1),2)+".";a+=daum.Number.fillZero(b.getDate(),2);return a}});
T.admin.Suggest=function(a){this.template='{if isInit}<div class="tag_suggest">{/if}{if !isInit}<div class="tag_suggest_inner">{for item in items}<div class="tag_suggest_item" data-index="${item_index}">${item}</div>{/for}</div>{/if}{if isInit}</div>{/if}';this.elements={};this.elements.input=a.input;this.attributes={};this.attributes.name=a.name;this.attributes.url=a.url;this.attributes.key=a.key;this.attributes.idx=-1;this.attributes.length=0;this.attributes.items=null;this.attributes.timer=null;this.attributes.keyword=null;this.attributes.selectedClassName=a.selectedClassName||"selected";this.attributes.callbackKeys=a.callbackKeys;this.parse=a.parse||function(){return[]};this.callback=a.callback||function(){};this.init()}.members({init:function(){var b=daum.createElement(this.getHtml({isInit:true}));document.body.appendChild(b);daum.Element.hide(b);this.elements.wrap=b;daum.Event.addEvent(b,"mouseover",this.onMouseOver.bind(this));daum.Event.addEvent(b,"mousedown",this.onMouseDown.bind(this));var a=this.elements.input;daum.Event.addEvent(a,"focus",this.onFocus.bind(this));daum.Event.addEvent(a,"blur",this.onBlur.bind(this));daum.Event.addEvent(a,"keydown",this.onKeyDown.bind(this))},getHtml:function(a){if(daum.Object.isString(this.template)){this.template=TrimPath.parseTemplate(this.template)}return this.template.process(a)},load:function(a){var b=this;new daum.Ajax({url:this.attributes.url,paramString:this.attributes.key+"="+encodeURIComponent(a),onsuccess:function(d){var c=b.parse(daum.jsonToObject(d.responseText));b.attributes.items=c;b.attributes.length=c.length;b.render(c)},onfailure:function(){b.render([])}}).request()},render:function(a){if(a.length>0){this.elements.wrap.innerHTML=this.getHtml({isInit:false,items:a,name:this.attributes.name});daum.Element.show(this.elements.wrap);this.setPosition();this.setSize()}else{daum.Element.hide(this.elements.wrap)}},setPosition:function(){var a=daum.Element.getCoords(this.elements.input);var c=0;var b=daum.Element.getParent(this.elements.input);while(b!==document.body){c+=b.scrollTop;b=daum.Element.getParent(b)}daum.Element.setPosition(this.elements.wrap,a.left,a.bottom-c)},setSize:function(){var a=daum.Element.getCoords(this.elements.input);var b=a.right-a.left;daum.Element.setWidth(this.elements.wrap,b)},check:function(){var a=daum.String.trim(this.elements.input.value);if(/,$/.test(a)){this.elements.input.value=a=a.substr(0,a.length-1);this.callback(a);this.load("")}else{if(a!==""&&a!==this.attributes.keyword){this.attributes.keyword=a;this.load(a)}}},clear:function(){this.attributes.idx=-1;this.attributes.length=0;this.attributes.items=null;this.attributes.keyword=null;var a=this.elements.wrap;a.innerHTML="";daum.Element.hide(a)},clearTimer:function(){if(this.attributes.timer){clearInterval(this.attributes.timer);this.attributes.timer=null}},onFocus:function(a){this.attributes.timer=daum.Function.interval(this.check.bind(this),100)},onBlur:function(a){this.clearTimer();this.clear()},onKeyDown:function(g){if(g.keyCode==38||g.keyCode==40){var b=(g.keyCode==40);var a=this.attributes.selectedClassName;var f=daum.$$("div."+a,this.elements.wrap)[0];var d;if(f){if(b){d=daum.Element.getNext(f)}else{d=daum.Element.getPrev(f)}}else{if(b){d=daum.$$("div.tag_suggest_item",this.elements.wrap)[0]}}if(d){if(f){daum.Element.removeClassName(f,a)}daum.Element.addClassName(d,a)}}else{if(g.keyCode==13){var f=daum.$$("div."+this.attributes.selectedClassName,this.elements.wrap)[0];if(f&&this.attributes.length>0){this.callback(f.innerHTML)}else{var c=daum.String.trim(this.elements.input.value);if(c!=""){this.callback(c)}}this.load("")}else{if(g.keyCode==27){this.render([])}}}},onMouseOver:function(d){var c=daum.Event.getElement(d);if(daum.Element.hasClassName(c,"tag_suggest_item")){var a=this.attributes.selectedClassName;var b=daum.$$("div."+a,this.elements.wrap)[0];if(b){daum.Element.removeClassName(b,a)}daum.Element.addClassName(c,a)}},onMouseDown:function(b){daum.Event.stopEvent(b);var a=daum.Event.getElement(b);if(daum.Element.hasClassName(a,"tag_suggest_item")){this.callback(a.innerHTML);this.render([])}}});
T.admin.Editor={PANEL_NAMES:["Title","Basic","Gift","FileBox","Tag","Location","Trackback","CCL","Plugin","Writing","Form"],elements:{pluginList:daum.$$("#ttEditEntry input[name=pluginList]")[0].value,applyEditorEventBtn:daum.$("applyEditorEvent"),eventOk:true},isSaving:false,init:function(){var b=daum.$$("#ttEditEntry input[name=editorStatus]")[0];b=!!b?b.value:"";if(daum.$$("#ttEditEntry input[name=outmoded]")[0].value==="1"){T.Dialog.show("newEventforEvent",{message:'<p class="txt_link">이벤트 참여는 새 에디터에서만 가능하여<br />새 에디터로 이동합니다.</p>',buttons:[{ok:function(){this.close()}}]})}if(b==="old"){T.Dialog.show("emptyTitle",{message:'<p class="txt_link">새 에디터로 저장된 글은 새 에디터로만 편집 가능합니다.</p>',buttons:[{ok:function(){this.close()}}]})}this.getEntry().initialize();this.getAttachment().initialize();if(daum.$$("#ttEditEntry input[name=uselessPMargin]")[0].value=="1"){var c=Editor.getCanvas();c.observeJob(Trex.Ev.__IFRAME_LOAD_COMPLETE,function(g){if(daum.$$("#ttEditEntry input[name=pMarginZero]")[0].value=="1"){c.getPanel("html").setRule("p","margin-top:0;margin-bottom:0;")}})}if(this.getEntry().getId()!=="0"){var e=daum.String.trim(daum.$$("#ttEditEntry input[name=content]")[0].value);var a=this.getAttachment().createDataForDaumEditor();if(b==="new"){Editor.backupPost("tistory_legacy_"+this.getEntry().getId(),{content:e,attachments:a})}Editor.modify({content:e,attachments:a});var f=this.getAttachment().getDataFromServer();if(!!f){daum.Array.each(f.map.data,function(h,g){h.dataSeq=g+1;this.getPanel("Location").addItemWhenEditing(h,h.dataSeq)}.bind(this))}}T.admin.Editor.UI.init();daum.Array.each(this.PANEL_NAMES,function(g){this.getPanel(g).init(this)}.bind(this));daum.Event.addEvent(daum.$$("#tistoryFoot .btn_provisionally")[0],"click",this.onTemporarySave.bindAsEventListener(this));daum.Event.addEvent(daum.$$("#tistoryFoot .btn_preview")[0],"click",this.onPreview.bindAsEventListener(this));daum.Event.addEvent(daum.$$("#tistoryFoot .btn_save")[0],"click",this.onSave.bindAsEventListener(this));daum.Event.addEvent(daum.$$("#tistoryFoot .btn_cancel")[0],"click",this.onCancel.bindAsEventListener(this));if(this.elements.applyEditorEventBtn&&daum.$$("#ttEditEntry input[name=eventData]")[0]){var d=this.elements.eventData=daum.jsonToObject(daum.$$("#ttEditEntry input[name=eventData]")[0].value);this.elements.eventTypes=[];if(d.trackback){this.elements.eventTypes.push({type:"Trackback",value:d.trackback})}if(d.tags){this.elements.eventTypes.push({type:"Tag",value:d.tags})}if(d.mapType){this.elements.eventTypes.push({type:"Map",value:d.mapType})}if(d.viewCategory||!!d.viewEvent){this.elements.eventTypes.push({type:"View",value:d.viewCategory})}this.elements.copyOfeventTypes=daum.Array.copy(this.elements.eventTypes);daum.Event.addEvent(this.elements.applyEditorEventBtn,"click",this.applyEditorEvent.bind(this,"first"));if(d.isJoined){this.elements.applyEditorEventBtn.checked=true;this.applyEditorEvent();this.elements.applyEditorEventBtn.disabled=true}if(daum.$$("#ttEditEntry input[name=autoMapsideBarEvent]")[0].value==="1"){this.elements.applyEditorEventBtn.checked=true;this.applyEditorEvent()}}if(daum.$$("#ttEditEntry input[name=postdevice]")[0]){this.elements.postdevice=daum.jsonToObject(daum.$$("#ttEditEntry input[name=postdevice]")[0].value)}window.makeAutoSaveMeta=this.makeAutoSaveMeta.bind(this);window.beforePostAutoLoad=this.beforePostAutoLoad.bind(this);window.postAutoLoad=this.postAutoLoad.bind(this);if(daum.$("kakaoStoryComment")){daum.Event.addEvent(daum.$("kakaoStoryComment"),"click",this.clearKscFieldMsg.bindAsEventListener(this))}if(daum.$("publishKakaoStoryChannel")){daum.Event.addEvent(daum.$("publishKakaoStoryChannel"),"click",this.toggleKscField.bindAsEventListener(this))}daum.Event.addEvent(daum.$("category"),"change",this.onCategoryChange.bindAsEventListener(this));this.loadSidebarState()},getEntry:function(){return T.admin.Editor.Entry},getAttachment:function(){return T.admin.Editor.Attachment},getPanel:function(a){return this["Panel"+a]},getSaveData:function(){var a={};var b=0;daum.Array.each(this.PANEL_NAMES,function(e){var d=this.getPanel(e);if(d.hasOwnProperty("getParam")){try{var g=d.getParam();daum.extend(a,g)}catch(f){++b}}}.bind(this));a.id=this.getEntry().getId();a.content=this.getEntry().getContent();a.isNewEditor=true;if(a.category=="-4"){a.visibility="0"}for(var c in a){a[c]=encodeURIComponent(a[c])}return b>0?null:a},isValidateSaveData:function(a){var b=this;if(!a){T.Dialog.show("emptyTitle",{message:'<p class="txt_link">저장 실패</p>',buttons:[{ok:function(){this.close()}}]});return false}else{if(a.title==""){T.Dialog.show("emptyTitle",{message:'<p class="txt_link">제목을 입력해 주세요</p>',buttons:[{ok:function(){this.close();b.getPanel("Title").elements.title.focus()}}]});return false}else{return true}}},onTemporarySave:function(a){Editor.getAutoSaver().save()},onPreview:function(g){var d=daum.$("ttEditPreview"),f;var a=this.getSaveData();a.title=(a.title!="")?a.title:"제목을 입력해주세요";a.tag=encodeURIComponent(this.getEntry().getTag());a.location="";for(var h in a){f=daum.createElement('<input type="hidden" name="'+h+'" />');d.appendChild(f);f.value=decodeURIComponent(a[h])}var c=this.getAttachment().createDataForSaveEntry(false);daum.Array.each(c,function(j){var e=j.split("=")[0];var i=decodeURIComponent(j.split("=")[1]);f=daum.createElement('<input type="hidden" name="'+e+'" />');d.appendChild(f);f.value=i});var b=this.getEntry().createLocalTagParams();daum.Array.each(b,function(j){var e=j.split("=")[0];var i=decodeURIComponent(j.split("=")[1]);f=daum.createElement('<input type="hidden" name="'+e+'" />');d.appendChild(f);f.value=i});d.submit();d.innerHTML=""},checkEventValue:function(){if(this.elements.applyEditorEventBtn&&this.elements.applyEditorEventBtn.checked){return daum.Array.map(this.elements.eventTypes,function(h){if(h.type=="View"){if(daum.$("viewChannel").value=="0"){T.Dialog.show("selectViewchannel",{message:'<p class="txt_link">view 분류선택을 해야<br />이벤트에 참여할 수 있습니다.</p>',buttons:[{ok:function(){this.close()}}]});return false}else{return true}}else{if(h.type=="Map"){var f=false;var g=function(){if(!daum.$("domesticLocation").checked){return false}if(daum.$$("#locationFieldWrap span.txt").length==0){return false}else{return true}};var c=function(){if(!daum.$("foreignLocation").checked){return false}if(daum.$("continentForLocationTag").value!=0||daum.$("nationForLocationTag").value!=0||daum.$("cityForLocationTag").value!=0){return true}else{return false}};switch(h.value){case"domestic":f=g();break;case"foreign":f=c();break;case"both":f=g()||c();break}if(!f){T.Dialog.show("requireMap",{message:'<p class="txt_link">이벤트에 참여하시려면<br/>지도를 첨부해 주세요.</p>',buttons:[{ok:function(){this.close()}}]});return false}else{return true}}else{var b=T.admin.Editor.elements.eventData.isAvailableEvent;if(b){var a=T.admin.Editor.Entry.getTag();if(a.indexOf("2013사진공모전")>-1||a.indexOf("2013 사진공모전")>-1){}else{alert("태그에 ‘2013사진공모전’을 입력 하셔야만 2013 사진공모전 이벤트를 참여하실 수 있습니다");return false}if(a.indexOf("봄")>-1||a.indexOf("여름")>-1||a.indexOf("가을")>-1||a.indexOf("겨울")>-1){}else{alert("2013 티스토리 사진공모전에 참여하시려면 계절을 입력해 주세요.(봄, 여름, 가을, 겨울)");return false}var e=window.Editor.getSidebar().getAttachments();var d=0;daum.Array.each(e,function(i){if(i.type=="image"){d=d+1}});if(d>0){return true}else{alert("이미지를 첨부하셔야 사진공모전 이벤트를 참여하실 수 있습니다.");return false}}else{alert("3시간 내에 이미 5개 포스트를 참여하셨습니다. 3시간에 5개 포스트만 참여하실 수 있습니다.");return false}}}})}else{return[]}},onSave:function(a){var b=this.checkEventValue();if(!daum.Array.contains(b,false)){this.saveSidebarState();this.getPanel("FileBox").Attachments.close();daum.Event.preventDefault(a);if(this.isSaving){return}this.isSaving=true;saveData=this.getSaveData();if(!this.isValidateSaveData(saveData)){this.isSaving=false;return}if(this.elements.applyEditorEventBtn&&this.elements.applyEditorEventBtn.checked){saveData.eventId=this.elements.eventData.eventId}this.checkTrackbackEnabled(saveData)}},onCategoryChange:function(c){var a=daum.Event.getElement(c);var b=a.options[a.selectedIndex].getAttribute("view");if(b){daum.$("daumLike").value=b;T.admin.Editor.PanelBasic.setVisibility(null,"publish")}},applyEditorEvent:function(a){var b=this.elements.eventData.isAvailableEvent;var d=this.elements.postdevice;if(d=="1"){alert("모바일에서 등록한 글은 이벤트에 참여 할 수 없습니다.");this.elements.applyEditorEventBtn.checked=false;return false}else{if(b){if(a=="first"){this.elements.copyOfeventTypes=daum.Array.copy(this.elements.eventTypes)}var c=this.elements.copyOfeventTypes.pop();if(c!=undefined){var e="applyeEditor"+c.type+"Event";this[e](c.value,this.applyEditorEvent.bind(this),this.elements.applyEditorEventBtn.checked)}if(this.elements.copyOfeventTypes.length==0){this.elements.copyOfeventTypes=daum.Array.copy(this.elements.eventTypes)}}else{alert("3시간 내에 이미 5개 포스트를 참여하셨습니다. 3시간에 5개 포스트만 참여하실 수 있습니다.");this.elements.applyEditorEventBtn.checked=false;return false}}},addEventforVisibility:function(){var a=this.getPanel("Basic");a.setVisibility(null,"publish");if(a.elements.visibilityEid){daum.Event.stopObserving(a.elements.visibilityEid);a.elements.visibilityEid=""}if(!this.elements.dontChangeVisibility){this.elements.dontChangeVisibility=daum.Event.addEvent(daum.$("visibilityOption"),"click",function(b){daum.Event.stopEvent(b);if(!daum.Element.hasClassName(daum.Event.getElement(b),"btn_publish")){T.Dialog.show("dontChangeVisibility",{message:'<p class="txt_link">발행 게시글만<br />이벤트에 참여 할 수 있습니다.</p>',buttons:[{ok:function(){this.close()}}]})}})}},removeEventforVisibility:function(){var a=this.getPanel("Basic");if(this.elements.dontChangeVisibility){daum.Event.stopObserving(this.elements.dontChangeVisibility);this.elements.dontChangeVisibility=""}if(!this.getPanel("Basic").elements.visibilityEid){a.elements.visibilityEid=daum.Event.addEvent(a.elements.visibility,"click",a.setVisibility.bind(a))}},applyeEditorViewEvent:function(i,l,j){var h=this.elements.applyEditorEventBtn;var b=this.PanelBasic.elements.viewChannel;var f=this.PanelBasic.elements.viewEvent;if(j){daum.Element.addClassName(daum.$("panelBasicset"),"on");if(!this.elements.eventData.isJoined){if(i=="none"){i=""}var c=function(m){if(m){this.addEventforVisibility();if(i){b.disabled=true;if(i.indexOf("event")>-1){f.disabled=true}}l()}else{h.checked=false;f.value="0"}}.bind(this);if(!/Daum view/.test(this.elements.pluginList)){T.Dialog.show("setDaumViewPlugin",{message:'<p class="txt_link">Daum view 플러그인을 설정해야 이벤트에 참여할 수 있습니다. 플러그인 설정 페이지로 이동하시겠습니까?</p>',buttons:[{ok:function(){this.close();location.href="/admin/plugin?name=pluginBloggerNews"},cancel:function(){h.checked=false;this.close()}}]})}else{if(/event-/.test(i)){if(this.getEntry().getId()!=="0"&&b.disabled){T.Dialog.show("confirmView",{message:'<p class="txt_link">기존에 뷰로 송고된 게시글은<br />뷰 이벤트 채널에 보낼 수 없습니다.</p>',buttons:[{ok:function(){this.close();c(false)}}]});return}else{var e=f.value=i.replace("event-","");var a=f.options[f.selectedIndex].id.replace("eventNo-","");var g=f.options[f.selectedIndex].title;b.value=g;if(b.value!=0){var d=b.options[b.selectedIndex].title;var k={name:pluginName+"/DaumBloggerNews_HandleSetEvent",eventId:a,eventValue:e,entryId:this.PanelBasic.attributes.entryId,categoryName:d,categoryId:g};this.Util.setDaumview(g,b,k,c)}}}else{if(this.getEntry().getId()!=="0"&&b.disabled&&i!=""&&i!=b.value){T.Dialog.show("confirmView",{message:'<p class="txt_link">이미 다른 채널에 게시글이 송고되어<br />뷰로 글을 보낼 수 없습니다.</p>',buttons:[{ok:function(){this.close();c(false)}}]});return}else{if(i!=""){f.value="0"}this.Util.setDaumview(i,null,null,c)}}}}else{this.addEventforVisibility();l()}}else{this.removeEventforVisibility();if((b&&selectedViewChannel=="")||(f&&selectedViewEvent=="")){b.disabled=false;f.disabled=false}l()}},applyeEditorMapEvent:function(c,d,a){if(a){daum.Element.replaceClassName(daum.$("panelTagAndLocation"),"tag_open","location_open");daum.Element.replaceClassName(daum.$("panelTagAndLocation"),"tag_on","location_on");this.addEventforVisibility();if(c!="both"){var b=daum.$(c+"Location");b.checked=true;this.getPanel("Location").setDomesticOrForeign(null,b)}}else{this.removeEventforVisibility()}d()},applyeEditorTagEvent:function(b,d,a){var c=this;if(a){daum.Element.replaceClassName(daum.$("panelTagAndLocation"),"location_open","tag_open");daum.Element.replaceClassName(daum.$("panelTagAndLocation"),"location_on","tag_on");this.elements.tagElem=[];this.elements.dontModifyTags=[];this.addEventforVisibility();daum.Array.each(b,function(e){var h=c.getPanel("Tag").addTag(e);c.elements.tagElem.push(h);var g=daum.$$("img",h)[0];daum.Element.hide(g);var f=daum.Event.addEvent(h,"click",function(i){daum.Event.stopEvent(i)});c.elements.dontModifyTags.push(f)})}else{this.removeEventforVisibility();if(!!this.elements.tagElem&&this.elements.tagElem.length>0){daum.Array.each(this.elements.tagElem,function(g,e){var f=daum.$$("img",g)[0];daum.Element.show(f,"inline");daum.Event.stopObserving(c.elements.dontModifyTags[e])})}}d()},applyeEditorTrackbackEvent:function(c,d,b){var a=daum.$("trackback");if(b){if(!this.elements.eventData.isJoined){daum.Element.addClassName(daum.$("panelTrackback"),"on");this.addEventforVisibility();a.value=c;a.disabled=true}}else{this.removeEventforVisibility();a.disabled=false}d()},checkTrackbackEnabled:function(a){var c=this;if(this.getPanel("Trackback").getUrl()){var b;if(a.visibility<2){b='<p class="txt_link">트랙백을 보내시려면 글이 공개 또는 발행으로 설정되어야 합니다.</p><p class="txt_link txt_link_more">공개설정을 변경하시겠습니까?</p>'}else{if(a.published!=0&&a.published!=1){b='<p class="txt_link">예약글인 경우 트랙백이 전송되지 않습니다.</p><p class="txt_link txt_link_more">시간 설정을 변경하시겠습니까?</p>'}}if(b){T.Dialog.show("confirmChangeVisibility",{message:b,buttons:[{ok:function(){this.close();c.isSaving=false;T.admin.Editor.UI.setStateSinglePanel("panelBasicset","o")}},{cancel:function(){this.close();c.getPanel("Trackback").clearUrl();c.save(a)}}]});return}}this.save(a)},getImageInContents:function(){var d=Editor.getContent();var e=/cfile[0-9]+\.uf@[^\._]+/ig;var b=d.match(e);var k={};if(b){for(var g=0,f=b.length;g<f;g++){var c=b[g];var c=c.split("@");var h=c[0];var a=c[1].split(".")[0];var j="http://"+h+".tistory.com/image/"+a;k[j]=true}}return k},save:function(n){T.Dialog.show("noticeSaving",{message:'<p class="txt_link">글을 저장하고 있습니다.</p>'});var p=this;var b=T.admin.Editor.Util;n.tag=encodeURIComponent(this.getEntry().getTag());n.location="";var g=this.getImageInContents();var m=T.admin.Editor.PanelFileBox.elements.thumbImage;representationImageArray=m.split("/");m="http://"+representationImageArray[2]+"/image/"+representationImageArray[4];if(g&&!g[m]){for(var c in g){n.thumbnail=encodeURIComponent(c.split("http://").join("").split(".tistory.com/image/").join("@"));break}}var h=b.objectToParamString(n);var e=this.getAttachment().createDataForSaveEntry(g);if(e.length>0){h+="&"+e.join("&")}var r=this.PanelFileBox.elements.deleteFiles;for(var q=r.length;q--;){h+=("&deleteFiles[]="+encodeURIComponent(r[q]))}if(n.isKorea=="true"){var s=this.getEntry().createLocalTagParams();if(s.length>0){h+="&"+s.join("&")}}else{var o=[];var a=this.getPanel("Location").elements;var j="";var d=["one","two","three"];var t={one:"continent",two:"nation",three:"city"};daum.Array.each(d,function(u){var i=t[u]+"Location";if(a[i].value!=0){o.push("world_"+u+"Code[]="+encodeURIComponent(a[i].value));j+=((j!="")?"|":"")+a[i].options[a[i].selectedIndex].title}});if(j!=""){o.push("world_addr[]="+encodeURIComponent(j))}if(o.length>0){h+="&"+o.join("&")}}var l=daum.$("daumLike").value;if(daum.$("publishKakaoStoryChannel")){var k=daum.$("publishKakaoStoryChannel").checked;var f=daum.$("kakaoStoryComment").value;if(k){h+="&publishKakaoStory="+k+"&publishKakaoStoryComment="+f}}if(!daum.$("daumLike").disabled&&l!=""){h+="&daumLike="+l}h+="&seq="+Editor.getAutosaveSeq();b.sendRequest({url:"/admin/entry/post/saveEntry.php",method:"POST",paramString:h,timeout:600000,onsuccess:function(v){var i=daum.jsonToObject(v.responseText);var u=i.data.entryId;var w=p.getPanel("Trackback").getUrl();if(w){p.sendTrackback(u,w)}else{Editor.permitUnload();p.leaveEditor()}T.Dialog.close();p.isSaving=false},onfailure:function(i){p.isSaving=false}})},sendTrackback:function(d,b){var c=this;var a=T.admin.Editor.Util;T.Dialog.show("sendTrackback",{message:'<p class="txt_link">트랙백을 전송하고 있습니다.</p>'});a.sendRequest({url:"/admin/entry/sendTrackback.php",method:"POST",paramString:"id="+d+"&url="+b,onsuccess:function(e){Editor.permitUnload();c.leaveEditor()},onfailure:function(e){daum.Function.timeout(function(){Editor.permitUnload();c.leaveEditor()},3000)}})},onCancel:function(a){this.saveSidebarState();Editor.permitUnload();this.leaveEditor(true)},leaveEditor:function(b){var c=opener||parent.opener;var a=daum.$$("input[name=backUrl]")[0].value;if(!!c&&a==="CLOSEME"){if(!b){c.location.reload()}window.close()}else{location.href=a}},loadSidebarState:function(){var a=T.util.Cookie.get("editorSidebar");if(!!a){T.admin.Editor.UI.setSidebarState(a)}},saveSidebarState:function(){var a=T.admin.Editor.UI.getSidebarState();T.util.Cookie.set("editorSidebar",a,86400)},makeAutoSaveMeta:function(){var b=daum.$("category");var c=daum.String.unescapeHTML(b.options[b.selectedIndex].innerHTML).replace("&nbsp;ㄴ ","");var a=b.value;switch(T.admin.Editor.PanelTitle.attributes.entryType){case"-2":c="공지";a="-2";break;case"-1":c="키워드";a="-1";break;case"-4":c="서식";a="-4";break}return{title:function(){var d=document.forms.tx_editor_form.title.value=daum.$("titleBox").value;return d||"제목없음"}(),category:function(){var d=document.forms.tx_editor_form.category.value=c;return d}(),categoryValue:function(){var d=document.forms.tx_editor_form.categoryValue.value=a;return d}()}},beforePostAutoLoad:function(){var a=T.admin.Editor.Util;a.sendRequest({url:"/admin/entry/post/removeDraftAttachments.php",method:"POST"});daum.$("fileList").innerHTML=""},postAutoLoad:function(a){var b=a.formfield;daum.$("titleBox").value=b.title;if(b.categoryValue<0){daum.$("category").value="0";daum.$("category").disabled=true;T.admin.Editor.PanelTitle.setEntryType(b.categoryValue)}else{daum.$("category").value=b.categoryValue}},toggleKscField:function(b){var a=daum.$("publishKakaoStoryChannel").checked;if(a){daum.$("kakaoStoryComment").disabled=false}else{daum.$("kakaoStoryComment").disabled=true}},clearKscFieldMsg:function(a){daum.Element.removeClassName(daum.$$(".txt_ksc")[0],"ksc_on");daum.Element.addClassName(daum.$$(".txt_ksc")[0],"ksc_on")}};
T.admin.Editor.Util={sendRequest:function(c){var a=c.onsuccess||function(){};var d=c.onfailure||function(){};c.onsuccess=function(g){try{var e=daum.jsonToObject(g.responseText);if(e.error==true){this.onfailure(g)}else{a(g)}}catch(f){this.onfailure(g)}};c.onfailure=function(g){var h,e;if(daum.Object.isString(g)&&g=="timeout"){h="응답이 없습니다. 다시 실행부탁드립니다."}else{try{e=daum.jsonToObject(g.responseText);h=e.data}catch(f){h="오류가 발생하였습니다. 다시 실행부탁드립니다."}}T.Dialog.close();T.Dialog.show("tDone",{message:'<p class="txt_link">'+h+"</p>",buttons:[{ok:function(){this.close();if(e&&e.requireLogin){T.admin.pageManager.openLoginPupup()}}}]});d(g)};c.onabort=function(){this.onfailure("timeout")};var b=new daum.Ajax(c);b.request();return b},getSelectedRadioValue:function(c){var a=daum.$$("[name="+c+"]");var b=this.getSelectedRadio(a);if(b==-1){return""}return(a[b])?a[b].value:a.value},getSelectedRadio:function(a){if(a[0]){for(var b=0;b<a.length;b++){if(a[b].checked){return b}}}else{if(a.checked){return 0}}return -1},objectToParamString:function(b){var a="",c;for(var d in b){if(b.hasOwnProperty(d)){c=""+b[d];a+="&"+d+"="+c}}if(a!=""){a=a.substr(1,a.length)}return a},ufConvert:function(d,e){var c=new RegExp("^http://(.+)\\.(?:tistory\\.com|daum\\.net)/\\w+/([0-9A-F]{22})$");var a=c.exec(d.attachurl);if(!a){return d.attachurl}var b=a[1]+"@"+a[2]+(e?"_":"");if(d.filename.lastIndexOf(".")!=-1){b+=d.filename.substring(d.filename.lastIndexOf("."))}return b},formatFileSize:function(a){if(a<1024){return a+" bytes"}else{if(a<1048576){return(Math.round(((a*10)/1024))/10)+" KB"}else{return(Math.round(((a*10)/1048576))/10)+" MB"}}},naturalSort:{isWhitespaceChar:function(b){return b.charCodeAt(0)<=32},isDigitChar:function(c){var b=c.charCodeAt(0);return(b>=48&&b<=57)},compareRight:function(g,d){var i=0;var h=0;var f=0;var e;var c;for(;;h++,f++){e=g.charAt(h);c=d.charAt(f);if(!this.isDigitChar(e)&&!this.isDigitChar(c)){return i}else{if(!this.isDigitChar(e)){return -1}else{if(!this.isDigitChar(c)){return +1}else{if(e<c){if(i==0){i=-1}}else{if(e>c){if(i==0){i=+1}}}}}}}},compare:function(j,i){var f=0,d=0;var e=0,c=0;var h,g;var k;while(true){e=c=0;h=j.charAt(f);g=i.charAt(d);while(this.isWhitespaceChar(h)||h=="0"){if(h=="0"){e++}else{e=0}h=j.charAt(++f)}while(this.isWhitespaceChar(g)||g=="0"){if(g=="0"){c++}else{c=0}g=i.charAt(++d)}if(this.isDigitChar(h)&&this.isDigitChar(g)&&(k=this.compareRight(j.substring(f),i.substring(d)))!=0){return k}if(h==0&&g==0){return e-c}if(h<g){return -1}else{if(h>g){return +1}}++f;++d}},sort:function(d){for(var c=0;c<d.length;c++){for(var b=1;b<d.length-c;b++){if(this.compare(d[b-1][0],d[b][0])>0){var a=d[b];d[b]=d[b-1];d[b-1]=a}}}return d}},getFileImage:function(a){var b=a.split(".");return"http://"+b[0]+"."+b[1].replace("@",".tistory.com/P150x100/")},hoverFileList:function(b,a,c){if(a=="over"){daum.Element.addClassName(b,"hover")}else{if(a=="out"){daum.Element.removeClassName(b,"hover")}}},isValidTime:function(c){var a=c.split(":")[0];var b=c.split(":")[1].split(" ")[0];var d=c.split(":")[1].split(" ")[1];if((a>=0&&a<=12)&&(b>=0&&b<=60)&&(d=="AM"||d=="PM")){return true}else{return false}},isValidDate:function(c){if(!this.isDateFormat(c)){return false}var d=[31,28,31,30,31,30,31,31,30,31,30,31];var a=c.split(".");var e=Number(a[0]);var g=Number(a[1]);var b=Number(a[2]);if(b==0){return false}var f=false;if(this.isLeaf(e)){if(g==2){if(b<=d[g-1]+1){f=true}}else{if(b<=d[g-1]){f=true}}}else{if(b<=d[g-1]){f=true}}return f},isDateFormat:function(a){var b=/[0-9]{4}.[0-9]{2}.[0-9]{2}/;return a.match(b)},isLeaf:function(b){var a=false;if(b%4==0){a=true;if(b%100==0){a=false}if(b%400==0){a=true}}return a},addActivity:function(b){var a=(!!b.className)?b:daum.Event.getElement(b);daum.Element.addClassName(a,"activity")},removeActivity:function(b){var a=(!!b.className)?b:daum.Event.getElement(b);daum.Element.removeClassName(a,"activity")},getRandomKey:function(){var b="";for(var a=0;a<6;a+=1){b+=Math.floor(Math.random()*(10-1+1))}return b},convertCoca2Tistory:function(b){var a={};a.name=this.ufConvert({attachurl:b[2],filename:b[0]});a.label=b[0];a.mime=b[8];a.size=b[6];a.width=0;a.height=0;a.ccResult=999;a.ccVersion=0;a.ccDate=new Date().toString();a.ccTrackId=0;return a},assortUfnamesFromFiles:function(c){var a=[];for(var b=0,d=c.length;b<d;++b){a.push(c[b][0])}return a},ufName2Url:function(a){return"http://"+a.split("@")[0]+".tistory.com/image/"+a.split("@")[1].split(".")[0]},setDaumview:function(c,d,a,f){var b;if(!!a){b=a}else{b={name:pluginName+"/DaumBloggerNews_HandleSetCategory",categoryId:c,entryId:T.admin.Editor.getEntry().getId()}}var e=this;this.sendRequest({url:"/admin/plugin/adminHandler.php?name="+pluginName+"/DaumBloggerNews_CheckAjaxAuthentication",timeout:10000,onsuccess:function(j){var g=daum.jsonToObject(j.responseText);var k=g.data;var h=daum.$("viewChannel");var i=daum.$("viewEvent");if(k.reg==true){if(c==""){if(f!=null){f(true)}return}if(h.disabled&&i.disabled){if(f!=null){f(true)}}else{e.sendRequest({url:"/admin/plugin/adminHandler.php",timeout:10000,paramString:e.objectToParamString(b),onsuccess:function(l){h.value=c;if(f!=null){f(true)}}})}}else{window.open(joinURL,"","width=493, height=410, scrollbars=no, status=no, resizable=yes");if(daum.$("applyEditorEvent")){daum.$("applyEditorEvent").checked=false}if(!!d){d.value="0"}}}})}};
T.admin.Editor.Entry=(function(){var b=function(){return daum.$$("#ttEditEntry input[name=id]")[0].value},g=function(){return Editor.getContent()},m=[],d=[],l=function(r){return daum.Array.contains(m,r)},a=function(r){m.push(r)},o=function(r){m[daum.Array.indexOf(m,r)]=null;m=daum.Array.compact(m)},q=function(){var r=[];daum.Array.each(d,function(s){if(!daum.Array.contains(m,s)){r.push(s)}});return r},n=function(){return(m.length>0)?m.join(","):""},c=[],f=0,i=function(){return f},e=function(r){f=parseInt(r)},h=function(r){c[++c.length]=r;return -(c.length-1)},p=function(r){c[-parseInt(r)]=null},k=function(){var r=[];daum.Array.each(c,function(t,s){if(!t){return}r.push("local_mapx[]="+encodeURIComponent(t.mapX));r.push("local_mapy[]="+encodeURIComponent(t.mapY));r.push("local_name[]="+encodeURIComponent(t.title));r.push("local_docid[]="+encodeURIComponent(t.docid||0));r.push("local_maptype[]="+encodeURIComponent(t.map_type||0));r.push("local_maphybrid[]="+encodeURIComponent(t.map_hybrid||0));r.push("local_raddress[]="+encodeURIComponent(t.addr||t.address));r.push("local_rcode[]="+encodeURIComponent(t.rcode||0));r.push("local_isdefault[]="+encodeURIComponent((s===-(i())?"Y":"N")));r.push("local_source[]="+encodeURIComponent(t.addtype||0));r.push("local_confirmid[]="+encodeURIComponent(t.confirmid))});return r},j=function(){var s=daum.String.trim(daum.$$("#ttEditEntry input[name=tags]")[0].value);m=(s=="")?[]:s.split(",");var r=daum.String.trim(daum.$$("#ttEditEntry input[name=siteTags]")[0].value);d=(r=="")?[]:r.split(",")};return{getId:b,getContent:g,hasTag:l,addTag:a,removeTag:o,getSiteTags:q,getTag:n,getDefaultLocalTagIndex:i,setDefaultLocalTagIndex:e,addLocalTag:h,removeLocalTag:p,createLocalTagParams:k,initialize:j}})();
T.admin.Editor.Attachment=(function(){var o=null,i=null,c=null,n=null,k=[],b=function(){return n},e=function(){var t=[];var v=n;daum.Array.each(["gallery","imazing","jukebox","bgm","movie","image","file"],function(w){var x=v[w];daum.Array.each(x.data,function(y){if(w=="gallery"||w=="imazing"||w=="jukebox"){y.files=g(y.files,w)}t.push({attacher:x.attacher,type:x.type,data:y})})});var u=daum.String.trim(daum.$$("#ttEditEntry input[name=content]")[0].value);var s=u.match(/emap_\d\d\d\d\d\d/g)||[];daum.Array.each(daum.Array.uniq(s),function(w){t.push({attacher:"map",type:"map",data:{articleno:i.getEntry().getId(),mapkey:w,alreadAttach:true}})});return t},g=function(u,t){var s=[];var v=daum.Array.map(u,function(w){return w[0]});daum.Array.each(k,function(y){var x=y.name;var w=daum.Array.indexOf(v,x);if(w>-1){s.push([u[w][0],(t=="jukebox")?y.label:""])}});return s},f=function(v){var s=[];var u=o.getSidebar().getAttachments();daum.Array.each(u,function(x,w){if(x.deletedMark==true){return}switch(x.type){case"image":if(v===false||(v&&v[x.key])){s=s.concat(m(x.type,x.data))}break;case"file":s=s.concat(m(x.type,x.data));break;case"gallery":case"imazing":case"jukebox":s=s.concat(h(x.type,x.data));break;case"movie":s=s.concat(a(x.type,x.data));break;case"map":if(!x.data.alreadAttach){s=s.concat(r(x.type,x.data))}break;case"bgm":s=s.concat(q(x.type,x.data));break}});var t=this.getDataFromServer()["map"].data;daum.Array.each(t,function(w){if(w.addtype=="1"){s=s.concat(r("map",w))}});return s},m=function(t,u){var s=[];s.push("file_name[]="+encodeURIComponent((u.key!=undefined)?u.key:c.ufConvert({attachurl:u.attachurl,filename:u.filename})));s.push("file_label[]="+encodeURIComponent(u.filename));s.push("file_mime[]="+encodeURIComponent(u.filemime));s.push("file_size[]="+encodeURIComponent(u.filesize));s.push("file_width[]="+encodeURIComponent(u.actualwidth||0));s.push("file_height[]="+encodeURIComponent(u.actualheight||0));s.push("file_ccResult[]="+999);s.push("file_ccVersion[]="+0);s.push("file_ccDate[]="+encodeURIComponent(new Date().toString()));s.push("file_ccTrackId[]="+0);return s},h=function(t,v){var s=[];var u=c.assortUfnamesFromFiles(v.files);s.push("supplement_type[]="+encodeURIComponent(t));s.push("supplement_file[]="+encodeURIComponent(u.join("|")));daum.Array.each(k,function(w){if(daum.Array.indexOf(u,w.name)>-1){s.push("file_name[]="+encodeURIComponent(w.name));s.push("file_label[]="+encodeURIComponent(w.label));s.push("file_mime[]="+encodeURIComponent(w.mime));s.push("file_size[]="+encodeURIComponent(w.size));s.push("file_width[]="+encodeURIComponent(w.width));s.push("file_height[]="+encodeURIComponent(w.height));s.push("file_ccResult[]="+999);s.push("file_ccVersion[]="+0);s.push("file_ccDate[]="+encodeURIComponent(new Date().toString()));s.push("file_ccTrackId[]="+0)}});return s},a=function(t,u){var s=[];s.push("movie_vid[]="+encodeURIComponent(u.moviekey));s.push("movie_thumbnail[]="+encodeURIComponent(u.thumburl));s.push("movie_preview[]="+encodeURIComponent(u.prevurl));s.push("movie_time[]="+encodeURIComponent(u.playtime));s.push("movie_isPublic[]="+encodeURIComponent((u.movieopen.toString()=="true")?"Y":"N"));s.push("movie_category[]="+encodeURIComponent(u.moviecate));s.push("movie_allowcopy[]="+encodeURIComponent((u.allowcopy.toString()=="true")?"Y":"N"));s.push("movie_title[]="+encodeURIComponent((u.title=="")?T.admin.Editor.PanelTitle.elements.title.value.trim():u.title));s.push("movie_uploadHost[]="+encodeURIComponent(u.uploadHost));return s},r=function(t,u){if(daum.$("domesticLocation").checked&&!u.deleteTag){var s=[];s.push("local_mapx[]="+encodeURIComponent(u.mapX));s.push("local_mapy[]="+encodeURIComponent(u.mapY));s.push("local_name[]="+encodeURIComponent(u.title));s.push("local_docid[]="+encodeURIComponent(u.docid||0));s.push("local_maptype[]="+encodeURIComponent(u.map_type));s.push("local_maphybrid[]="+encodeURIComponent(u.map_hybrid));s.push("local_raddress[]="+encodeURIComponent(u.addr));s.push("local_rcode[]="+encodeURIComponent(u.rcode));s.push("local_isdefault[]="+encodeURIComponent((u.dataSeq==i.Entry.getDefaultLocalTagIndex()?"Y":"N")));s.push("local_source[]="+encodeURIComponent(u.addtype));s.push("local_confirmid[]="+encodeURIComponent(u.confirmid));return s}},q=function(t,u){var s=[];s.push("bgm_songid[]="+encodeURIComponent(u.songid));s.push("bgm_bgmtrackid[]="+encodeURIComponent(u.bgmlist[0]));s.push("bgm_title[]="+encodeURIComponent(u.title));s.push("bgm_artist[]="+encodeURIComponent(u.artist));s.push("bgm_key[]="+encodeURIComponent(u.bgmkey));return s},l=function(s,u,t){Editor.getSidebar().getAttacher(s).execAttach(u,t)},p=function(s){k.push(s)},j=function(s){for(var t=k.length;t--;){if(k[t].name==s){return k[t].label}}return""},d=function(){o=window.Editor;i=T.admin.Editor;c=T.admin.Editor.Util;try{n=daum.jsonToObject(daum.$$("#ttEditEntry input[name=attachments]")[0].value);k=n.attachFiles}catch(s){console.log(s)}};return{getDataFromServer:b,createDataForDaumEditor:e,createDataForSaveEntry:f,execAttach:l,registFile:p,getFileLabel:j,initialize:d}})();
T.admin.Editor.UI={init:function(){this.resizingLayout();daum.Event.addEvent(window,"resize",this.resizingLayout);this.initSinglePanel("panelBasicset");this.initSinglePanel("panelGift");this.initSinglePanel("panelFilebox");this.initDualPanel("panelTagAndLocation","tag","location");this.initSinglePanel("panelTrackback");this.initSinglePanel("panelCcl");this.initSinglePanel("panelPlugin");this.initSinglePanel("panelKakaoStoryChannel");this.initDualPanel("panelWritingAndForm","listwriting","form");var c=daum.$("tistoryGnb");daum.Event.addEvent(c,"click",function(f){daum.Event.stopPropagation(f);var d=daum.Event.getElement(f);if(d.className!=""||d.tagName.toLowerCase()!="a"){daum.Event.preventDefault(f);if(daum.Element.hasClassName(c,"on")){daum.Element.removeClassName(c,"on")}else{daum.Element.addClassName(c,"on")}}});var b=daum.$("tx_autosave");var a=daum.$$("dl",b)[0];daum.Event.addEvent(daum.$$(".btn_tempsave",b)[0],"click",function(d){if(daum.Element.hasClassName(b,"on")){daum.Element.removeClassName(b,"on")}else{daum.Element.addClassName(b,"on")}});daum.Event.addEvent(document,"click",function(d){daum.Element.removeClassName(c,"on");if(daum.Element.hasClassName(b,"on")){daum.Element.removeClassName(b,"on");Editor.getAutoSaver().toggleList()}});Editor.getCanvas().observeJob(Trex.Ev.__CANVAS_PANEL_CLICK,function(d){daum.Element.removeClassName(c,"on");daum.Element.removeClassName(b,"on")})},resizingLayout:function(g){var d=daum.$E("tistoryHead").getCoords();var b=daum.$E("tistoryHead").getCoords();var c=d.bottom+b.bottom-d.top-b.top+7;var a=(window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight)-c;daum.Array.each(["tistoryContent","cMain","mArticle","mAside"],function(e){daum.$E(e).setHeight(a)});var f=window.innerWidth||document.documentElement.clientWidth;f=(f<1169)?1169:f;daum.$E("tistoryWrap").setWidth(f);Editor.setFixedEditorHeight(a-50);Editor.refreshSize()},initSinglePanel:function(b){var a=daum.$(b);var d=daum.$$("a.btn_open",a)[0];var c=daum.$$("a.btn_close",a)[0];daum.Event.addEvent(d,"click",function(f){daum.Event.preventDefault(f);daum.Element.addClassName(a,"on")});daum.Event.addEvent(c,"click",function(f){daum.Event.preventDefault(f);daum.Element.removeClassName(a,"on")})},initDualPanel:function(e,f,d){var c=daum.$(e);var h=daum.$$("a.btn_open",c)[0];var g=daum.$$("a.btn_close",c)[0];var b=daum.$$("a."+f,c)[0];var a=daum.$$("a."+d,c)[0];daum.Event.addEvent(h,"click",function(i){daum.Event.preventDefault(i);if(daum.Element.hasClassName(c,f+"_on")){daum.Element.addClassName(c,f+"_open");daum.Element.removeClassName(c,d+"_open")}else{daum.Element.removeClassName(c,f+"_open");daum.Element.addClassName(c,d+"_open")}});daum.Event.addEvent(g,"click",function(i){daum.Event.preventDefault(i);daum.Element.removeClassName(c,f+"_open");daum.Element.removeClassName(c,d+"_open")});daum.Event.addEvent(b,"click",function(i){daum.Event.preventDefault(i);daum.Element.addClassName(c,f+"_on");daum.Element.addClassName(c,f+"_open");daum.Element.removeClassName(c,d+"_on");daum.Element.removeClassName(c,d+"_open")});daum.Event.addEvent(a,"click",function(i){daum.Event.preventDefault(i);daum.Element.removeClassName(c,f+"_on");daum.Element.removeClassName(c,f+"_open");daum.Element.addClassName(c,d+"_on");daum.Element.addClassName(c,d+"_open")})},getSidebarState:function(){var a=[];a.push(this.getStateSinglePanel("panelBasicset"));a.push(this.getStateSinglePanel("panelFilebox"));a.push(this.getStateDualPanel("panelTagAndLocation","tag","location"));a.push(this.getStateSinglePanel("panelTrackback"));a.push(this.getStateSinglePanel("panelCcl"));a.push(this.getStateSinglePanel("panelPlugin"));a.push(this.getStateDualPanel("panelWritingAndForm","listwriting","form"));return a.join("|")},setSidebarState:function(b){var a=b.split("|");this.setStateSinglePanel("panelBasicset",a.shift());this.setStateSinglePanel("panelFilebox",a.shift());this.setStateDualPanel("panelTagAndLocation","tag","location",a.shift());this.setStateSinglePanel("panelTrackback",a.shift());this.setStateSinglePanel("panelCcl",a.shift());this.setStateSinglePanel("panelPlugin",a.shift());this.setStateDualPanel("panelWritingAndForm","listwriting","form",a.shift())},getStateSinglePanel:function(b){var a=daum.$(b);return daum.Element.hasClassName(a,"on")?"o":"c"},getStateDualPanel:function(c,d,b){var a=daum.$(c);if(daum.Element.hasClassName(a,d+"_open")){return"fo"}else{if(daum.Element.hasClassName(a,d+"_on")){return"fc"}else{if(daum.Element.hasClassName(a,b+"_open")){return"so"}else{if(daum.Element.hasClassName(a,b+"_on")){return"sc"}}}}},setStateSinglePanel:function(b,c){var a=daum.$(b);if(c=="o"){daum.Element.addClassName(a,"on")}else{daum.Element.removeClassName(a,"on")}},setStateDualPanel:function(c,e,b,d){var a=daum.$(c);daum.Element.removeClassName(a,e+"_on");daum.Element.removeClassName(a,e+"_open");daum.Element.removeClassName(a,b+"_on");daum.Element.removeClassName(a,b+"_open");switch(d){case"fo":daum.Element.addClassName(a,e+"_open");case"fc":daum.Element.addClassName(a,e+"_on");break;case"so":daum.Element.addClassName(a,b+"_open");case"sc":daum.Element.addClassName(a,b+"_on");break}}};
T.admin.Editor.PanelTitle={editor:null,elements:{category:daum.$("category"),title:daum.$("titleBox"),formQuestion:daum.$("formQuestion")},attributes:{entryType:daum.$$("#ttEditEntry input[name=entryType]")[0].value,entryId:daum.$$("#ttEditEntry input[name=id]")[0].value,uselessPMargin:daum.$$("#ttEditEntry input[name=uselessPMargin]")[0].value,pMarginZero:daum.$$("#ttEditEntry input[name=pMarginZero]")[0].value},init:function(a){var c=this;this.editor=a;this.util=this.editor.Util;var b=this.elements.formQuestion;this.elements.uselessMarginValue=this.attributes.pMarginZero;if(daum.$$("#ttEditEntry input[name=useSlogan]")[0].value&&this.attributes.entryId==0){this.setTitle()}this.setEntryType();daum.Event.addEvent(this.elements.category,"change",this.selectCategory.bind(this));daum.Event.addEvent(daum.$("entry"),"click",this.setEntryType.bind(this));daum.Event.addEvent(daum.$("notice"),"click",this.setEntryType.bind(this));daum.Event.addEvent(daum.$("keyword"),"click",this.setEntryType.bind(this));daum.Event.addEvent(daum.$("form"),"click",this.setEntryType.bind(this));daum.Event.addEvent(b,"mouseover",function(){daum.Element.addClassName(b.parentNode,"on")});daum.Event.addEvent(b,"mouseout",function(){daum.Element.removeClassName(b.parentNode,"on")});daum.Event.addEvent(b,"click",function(d){daum.Event.preventDefault(d)});daum.Event.addEvent(this.elements.title,"focus",this.util.addActivity);daum.Event.addEvent(this.elements.title,"blur",this.util.removeActivity);daum.Event.addEvent(this.elements.title,"keydown",function(d){if(d.keyCode==9){daum.Event.preventDefault(d);Editor.focusOnTop()}});if(this.attributes.uselessPMargin=="1"){this.elements.pmarginQuestion=daum.$("pNoMarginQuestion");this.elements.uselessMarginForEntry=daum.$("uselessMarginForEntry");this.elements.boxPMarginInfo=daum.$("boxPMarginInfo");document.body.appendChild(this.elements.boxPMarginInfo);daum.Event.addEvent(this.elements.pmarginQuestion,"click",function(d){daum.Event.preventDefault(d)});daum.Event.addEvent(this.elements.uselessMarginForEntry,"click",function(d){daum.Event.preventDefault(d)});this.toggleCheckbox("source","html");Editor.getCanvas().observeJob(Trex.Ev.__CANVAS_MODE_INITIALIZE,this.toggleCheckbox.bind(this));Editor.getCanvas().observeJob(Trex.Ev.__CANVAS_MODE_CHANGE,this.toggleCheckbox.bind(this))}},getParam:function(){var a={};if(parseInt(this.attributes.entryType)<0){a.category=this.attributes.entryType}else{a.category=this.elements.category.value}a.title=this.elements.title.value;if(!!this.elements.uselessMarginForEntry){a.uselessMarginForEntry=this.elements.uselessMarginValue}else{a.uselessMarginForEntry="0"}return a},setEntryType:function(e){var f=this.attributes.entryType;var g={"0":"entry","-2":"notice","-1":"keyword","-4":"form"};if(e){if(typeof e=="string"){f=e;daum.$(g[f]).click()}else{if(typeof e=="object"&&e.type=="click"){var d=daum.Event.getElement(e).value;var c=g[d];if(f!=d){daum.$("wrapOption").className="toolbar_option choice_"+c;f=d}}}}if(g[f]=="notice"||g[f]=="keyword"){var b=this.editor.PanelBasic;var a=Math.abs(b.attributes.selectedVisibility);if(daum.$("absoluteAddr")!=null){daum.Element.hide(daum.$("absoluteAddr"))}if(a==0||a==1){b.setVisibility(null,"private")}else{b.setVisibility(null,"public")}}this.elements.category.disabled=(parseInt(f)<0);this.attributes.entryType=f},setTitle:function(){var a=this.elements.title;daum.Event.addEvent(a,"blur",this.applySlogan.bind(this));daum.Event.addEvent(a,"keydown",this.applySlogan.bind(this))},applySlogan:function(b){if((b.type=="keydown"&&b.keyCode=="13")||b.type=="blur"){var a=daum.Event.getElement(b);var c=a.value;c=c.replace(/-+/g,"");c=c.replace(/[!-\/:-@[-`{-~]+/g,"");c=c.replace(/^-+|-+$/g,"");c=c.trim();c=c.replace(/\\s+/g," ");c=c.replaceAll(" ","-");daum.$$(".tf_absolutely",daum.$("absoluteAddr"))[0].value=c}},selectCategory:function(c){if(!!daum.$("viewChannel")){var b=this.elements.category;var a=b.options[b.selectedIndex].getAttribute("view");if(a!=""){this.editor.PanelBasic.setVisibility(null,"publish");this.util.setDaumview(a,b)}}},toggleCheckbox:function(d,c){var a=this.elements.pmarginQuestion;var b=this.elements.uselessMarginForEntry;if(c=="source"){daum.Element.addClassName(b,"tx-disable");daum.Event.stopObserving(this.elements.questionOverEid);daum.Event.stopObserving(this.elements.questionOutEid);daum.Event.stopObserving(this.elements.marginEntryClickEid)}else{daum.Element.removeClassName(b,"tx-disable");this.elements.questionOverEid=daum.Event.addEvent(a,"mouseover",this.showLayer.bind(this));this.elements.questionOutEid=daum.Event.addEvent(a,"mouseout",this.hideLayer.bind(this));this.elements.marginEntryClickEid=daum.Event.addEvent(b,"click",this.usePMargin.bind(this))}},usePMargin:function(c){var a=Editor.getCanvas();var b=this.elements.uselessMarginForEntry;if(daum.Element.hasClassName(b,"tx-pmargin-switchtoggle")){daum.Element.replaceClassName(b,"tx-pmargin-switchtoggle","tx-pmargin-switchtoggle-pushed");a.getPanel("html").setRule("p","margin-top:0;margin-bottom:0;");this.elements.uselessMarginValue=1}else{daum.Element.replaceClassName(b,"tx-pmargin-switchtoggle-pushed","tx-pmargin-switchtoggle");a.getPanel("html").setRule("p","");this.elements.uselessMarginValue=0}},showLayer:function(d){var c=this.elements.boxPMarginInfo;var f=daum.Element.getCoords(this.elements.pmarginQuestion);var b=0;var a=daum.Element.getParent(this.elements.pmarginQuestion);while(a!==document.body){b+=a.scrollTop;a=daum.Element.getParent(a)}daum.Element.setPosition(c,f.left-99,f.top+20-b);daum.Element.show(c)},hideLayer:function(a){daum.Element.hide(this.elements.boxPMarginInfo)}};
T.admin.Editor.PanelBasic={editor:null,elements:{panel:daum.$("panelBasicset"),timeList:daum.$("timeList"),viewChannel:daum.$("viewChannel"),viewEvent:daum.$("viewEvent"),visibility:daum.$("visibilityOption"),publishedOption:daum.$("published"),password:daum.$("wrapPassword"),passwordInput:daum.$("password"),classification:daum.$("classification"),reservation:daum.$("reservation"),sloganBox:daum.$("absoluteAddrInput")},attributes:{selectedPublished:daum.$$("#ttEditEntry input[name=published]")[0].value,selectedVisibility:daum.$$("#ttEditEntry input[name=visibility]")[0].value,useSlogan:daum.$$("#ttEditEntry input[name=useSlogan]")[0].value,entryId:daum.$$("#ttEditEntry input[name=id]")[0].value},init:function(e){this.editor=e;this.util=this.editor.Util;var d=daum.$("absoluteAddr");var g=this.elements.sloganBox;var c=this.elements.passwordInput;this.elements.inputDate=daum.$$(".tf_reservation",this.elements.panel)[0];this.elements.inputTime=daum.$$(".tf_timeselect",this.elements.panel)[0];this.elements.oldDate,this.elements.oldTime;if(this.elements.viewChannel!=null&&this.elements.viewEvent!=null){if(selectedViewChannel!=""){this.elements.viewChannel.value=selectedViewChannel;this.elements.viewChannel.disabled=true;this.elements.viewEvent.disabled=true}else{if(selectedViewEvent!=""){this.elements.viewEvent.value=selectedViewEvent;if(this.elements.viewEvent.selectedIndex>0){this.elements.viewChannel.value=this.elements.viewEvent.options[this.elements.viewEvent.selectedIndex].title;this.elements.viewChannel.disabled=true;this.elements.viewEvent.disabled=true}else{this.elements.viewEvent.value=0}}}}if(this.elements.sloganBox!=null){this.setSlogan(d)}daum.Event.addEvent(c,"focus",this.util.addActivity);daum.Event.addEvent(c,"blur",this.util.removeActivity);this.elements.visibilityEid=daum.Event.addEvent(this.elements.visibility,"click",this.setVisibility.bind(this));daum.Event.addEvent(this.elements.publishedOption,"click",this.setPublished.bind(this));if(!!daum.$("viewChannel")){daum.Event.addEvent(this.elements.viewChannel,"change",this.selectViewChannel.bind(this));daum.Event.addEvent(this.elements.viewEvent,"change",this.selectViewEvent.bind(this))}var f=new T.admin.DatePicker({input:daum.$$("input.tf_reservation")[0],button:daum.$$("a.btn_calendar")[0],realDate:new Date(parseInt(daum.$$("#ttEditEntry input[name=realDate]")[0].value))});daum.Event.addEvent(window,"resize",f.setPosition.bind(f));daum.Event.addEvent(daum.$("mAside"),"scroll",f.setPosition.bind(f));daum.Event.addEvent(this.elements.inputDate,"focus",this.focusOnInput.bind(this,"date"));daum.Event.addEvent(this.elements.inputDate,"blur",this.blurOnInput.bind(this,"date"));daum.Event.addEvent(this.elements.inputTime,"focus",this.focusOnInput.bind(this,"time"));daum.Event.addEvent(this.elements.inputTime,"blur",this.blurOnInput.bind(this,"time"));daum.Event.addEvent(this.elements.inputTime,"click",function(h){daum.Event.stopPropagation(h)});daum.Event.addEvent(daum.$$(".btn_dropdown",this.elements.panel)[0],"click",this.toggleTimelistLayer.bind(this));daum.Event.addEvent(this.elements.timeList,"click",this.selectTime.bind(this));if(daum.Browser.ie6){var b=daum.$$("li",this.elements.timeList);for(var a=b.length;a--;){daum.Event.addEvent(b[a],"mouseover",this.util.hoverFileList.bind(this,b[a],"over"));daum.Event.addEvent(b[a],"mouseout",this.util.hoverFileList.bind(this,b[a],"out"))}}Editor.getCanvas().observeJob(Trex.Ev.__CANVAS_PANEL_CLICK,function(h){f.close(h);if(daum.Element.visible(this.elements.timeList)){this.toggleTimelistLayer(h)}}.bind(this));daum.Event.addEvent(document,"click",function(h){if(daum.Element.visible(this.elements.timeList)){this.toggleTimelistLayer(ev)}}.bind(this))},getParam:function(){var a={};if(this.attributes.selectedPublished==2){var b=this.elements.inputDate.value.replace(/\./g,"/");selectedPublished=Math.floor(Date.parse(b+" "+this.elements.inputTime.value)/1000);this.attributes.selectedPublished=selectedPublished}a.acceptComment=daum.$("acceptCommnet").checked?1:0;a.acceptTrackback=daum.$("acceptTrackback").checked?1:0;a.password=daum.$("password").value;a.published=this.attributes.selectedPublished;a.visibility=Math.abs(this.attributes.selectedVisibility);a.slogan=(this.elements.sloganBox!=null)?this.elements.sloganBox.value:"";return a},toggleTimelistLayer:function(c){daum.Event.stopEvent(c);var a=this.elements.timeList;var b=this.elements.inputTime;if(daum.Element.visible(a)){this.util.removeActivity(b);daum.Element.hide(a)}else{this.util.addActivity(b);daum.Element.show(a)}},selectTime:function(b){daum.Event.preventDefault(b);var a=daum.Event.getElement(b);if(a.tagName=="LI"){a=daum.$$("a",a)[0]}else{if(a.tagName=="SPAN"){a=a.parentNode}}this.elements.inputTime.value=a.getAttribute("value");this.toggleTimelistLayer(b)},selectViewChannel:function(c){this.elements.viewEvent.value=0;var b=daum.Event.getElement(c);var a=b.value;this.util.setDaumview(a,b)},selectViewEvent:function(g){var f=daum.Event.getElement(g);var h=f.value;var b=f.options[f.selectedIndex].id.replace("eventNo-","");if(b){var d=f.options[f.selectedIndex].title;this.elements.viewChannel.value=d;var c=this.elements.viewChannel.options[this.elements.viewChannel.selectedIndex].title;var a={name:pluginName+"/DaumBloggerNews_HandleSetEvent",eventId:b,eventValue:h,entryId:this.attributes.entryId,categoryName:c,categoryId:d};this.util.setDaumview(d,f,a)}},setVisibility:function(f,c){if(f){daum.Event.preventDefault(f);var d=daum.Event.getElement(f);c=d.className.split("btn_tab btn_").join("")}var a=this.elements.visibility.parentNode;a.className=c;var b={"private":"0",protection:"1","public":"2",publish:"3"};this.attributes.selectedVisibility=b[c];if(daum.$("panelKakaoStoryChannel")){daum.Element.removeClassName(daum.$("panelKakaoStoryChannel"),"hidden")}if(this.attributes.selectedVisibility!=3){if(daum.$("panelKakaoStoryChannel")){daum.Element.addClassName(daum.$("panelKakaoStoryChannel"),"hidden")}}},setPublished:function(d){daum.Event.preventDefault(d);var c=daum.Event.getElement(d);var f=this.elements.publishedOption.parentNode.parentNode;var b=c.className.split("btn_tab btn_").join("");f.className="list_basicset "+b;var a={maintain:"0",present:"1",reservation:"2"};this.attributes.selectedPublished=a[b]},setSlogan:function(a){var b=this.elements.sloganBox;daum.Event.addEvent(b,"focus",this.util.addActivity);daum.Event.addEvent(b,"blur",this.util.removeActivity)},focusOnInput:function(a,c){var b=daum.Event.getElement(c);if(a=="date"){this.elements.oldDate=b.value}else{this.elements.oldTime=b.value}this.util.addActivity(c)},blurOnInput:function(a,c){var b=daum.Event.getElement(c).value;if(a=="date"){if(!this.util.isValidDate(b)){this.elements.inputDate.value=this.elements.oldDate}}else{if(!this.util.isValidTime(b)){this.elements.inputTime.value=this.elements.oldTime}}this.util.removeActivity(c)}};
T.admin.Editor.PanelFileBox={editor:null,elements:{panel:daum.$("panelFilebox"),addFileBtn:daum.$("addFile"),deleteAllBtn:daum.$("deleteAll"),wrapFileLayout:daum.$("fileLayout"),id:daum.$$("#ttEditEntry input[name=id]")[0].value,thumbImage:daum.$$("#ttEditEntry input[name=thubmnail]")[0].value,previewImg:daum.$("wrapPreviewImg"),wrapThumbImgCheckbox:daum.$("setThumbImage"),thumbnailCheckBox:daum.$("thumbnailCheckBox"),wrapFileList:daum.$("fileList"),clickedList:"",deleteFiles:[]},templates:{fileList:new daum.Template('<li><span class="name" title="#{title}">#{name}</span><span class="btn"><a href="#" class="btn_comm btn_filedelete">삭제하기</a><a href="#" class="btn_comm btn_fileinsert"></a></span></li>')},init:function(d){this.editor=d;var e=this.elements.wrapFileList;var b=this.getFileList();this.elements.previewImg.src="http://i1.daumcdn.net/cfs.tistory/static/admin/editor/renew/sicon_org.gif";daum.Event.addEvent(this.elements.addFileBtn,"click",function(h){daum.Event.preventDefault(h);Editor.getSidebar().getAttacher("file").execute("boxonly=true")});for(var c=b.length;c--;){daum.Event.addEvent(b[c],"click",this.clickFileList.bind(this));if(daum.Browser.ie6){daum.Event.addEvent(b[c],"mouseover",this.editor.Util.hoverFileList.bind(this,b[c],"over"));daum.Event.addEvent(b[c],"mouseout",this.editor.Util.hoverFileList.bind(this,b[c],"out"))}}daum.Event.addEvent(this.elements.thumbnailCheckBox,"click",this.setThumbImage.bind(this));daum.Event.addEvent(this.elements.deleteAllBtn,"click",this.deleteFile.bind(this,true,null));daum.Event.addEvent(this.elements.wrapFileLayout,"click",this.addFileforLayout.bind(this));e.onselectstart=function(){return false};this.Attachments.init(this.editor);var g=this;var f=Editor.getAttachBox();f.observeJob(Trex.Ev.__ENTRYBOX_ENTRY_ADDED,this.addFileList.bind(this));f.observeJob(Trex.Ev.__ENTRYBOX_ENTRY_MODIFIED,this.modifyFileList.bind(this));var a=Editor.getCanvas();a.observeJob("tistory.attachment.custom.clicked",function(h,i){g.Attachments.open(h,i)});a.observeJob(Trex.Ev.__CANVAS_PANEL_KEYDOWN,function(h){g.Attachments.close()});Editor.getToolbar().observeJob(Trex.Ev.__TOOL_CLICK,function(h){if(h!="moreless"){g.Attachments.close()}})},getParam:function(){var a={};var c=this.elements.thumbImage;if(/\.mini/.test(c)){c=c.replace(/\.mini/,"")}else{if(!!c){var d=c.replace(/http:\/\//,"").split(".");var b=c.split("/").pop();c=d[0]+"."+d[1]+"@"+b}}a.thumbnail=c;return a},setThumbImage:function(){this.elements.thumbImage=this.elements.clickedList.imgSrc},addFileList:function(c){var a=T.admin.Editor.Util;var b=c.type;var d=this.templates.fileList.toElement({title:daum.String.escapeHTML(c.boxAttr.name),name:daum.String.escapeHTML(daum.String.cutString(c.boxAttr.name,28,".."))});if(b=="image"){a.sendRequest({url:"/admin/entry/post/getImageSize.php",method:"POST",paramString:"url="+c.data.originalurl.replace("original","info"),onsuccess:function(f){var e=daum.jsonToObject(f.responseText);c.data.actualwidth=e.data.width;c.data.actualheight=e.data.height},onfailure:function(e){}})}if(b=="jukebox"||b=="imazing"||b=="gallery"){d.id=c.key}d.fileType=(b=="file")?c.data.filename.split(".").pop():b;d.name=c.key;d.label=(c.data.filename==undefined)?"":c.data.filename;d.imgSrc=(c.boxAttr.image==undefined)?"":c.boxAttr.image;if(b=="movie"){d.imgSrc=d.imgSrc.replace("image","P120x80")}d.attachurl=(c.data.attachurl==undefined)?"":c.data.attachurl;d.isSelected=false;d.index=Editor.getSidebar().getAttachments().length-1;if(b=="image"||b=="file"){d.mime=c.data.filemime;d.filesize=(c.data.filesize==undefined)?"0":c.data.filesize;d.width=(c.data.actualwidth==undefined)?"0":c.data.actualwidth;d.height=(c.data.actualheight==undefined)?"0":c.data.actualheight;d.name=this.editor.Util.ufConvert({attachurl:d.attachurl,filename:d.label})}if(this.elements.thumbImage==""&&(b=="image"||b=="movie")){this.elements.thumbImage=d.imgSrc}if(!daum.Element.visible(this.elements.wrapFileList)){daum.Element.show(this.elements.wrapFileList)}this.elements.wrapFileList.appendChild(d);daum.Event.addEvent(d,"click",this.clickFileList.bind(this));if(daum.Browser.ie6){daum.Event.addEvent(d,"mouseover",this.editor.Util.hoverFileList.bind(this,d,"over"));daum.Event.addEvent(d,"mouseout",this.editor.Util.hoverFileList.bind(this,d,"out"))}},modifyFileList:function(a){daum.Array.each(this.getFileList(),function(c){if(c.label==a.data.filename){var d=a.boxAttr.image;var b=c.imgSrc;c.imgSrc=d;c.width=a.data.actualwidth;c.height=ltem.data.actualheight;if(this.elements.thumbImage==b){this.elements.thumbImage=d}}})},clickFileList:function(d){daum.Event.preventDefault(d);var c=daum.Event.getElement(d);var a=c.parentNode.parentNode;var b=(daum.Browser.mac)?d.metaKey:d.ctrlKey;if(b){b="ctrl"}else{if(d.shiftKey){b="shift"}}if(daum.Element.hasClassName(c,"btn_filedelete")){this.deleteFile(false,a)}else{if(daum.Element.hasClassName(c,"btn_fileinsert")){this.appendFile(a.index)}else{if(daum.Element.hasClassName(c,"name")){a=c.parentNode;this.setPreviewImg(a);this.setSelectedList(a,b)}}}},setPreviewImg:function(e){var a=this.elements.wrapThumbImgCheckbox;var d=this.elements.thumbnailCheckBox;var c="http://i1.daumcdn.net/cfs.tistory/static/admin/editor/renew/sicon_";var b=e.fileType;daum.Element.hide(a);if(b=="image"||b=="movie"){c=e.imgSrc;daum.Element.show(a);if(this.elements.thumbImage==e.imgSrc){d.checked=true;d.disabled=true}else{d.checked=false;d.disabled=false}}else{if(b=="bgm"){c+="daum.gif"}else{if(b=="doc"||b=="docx"){c+="doc.gif"}else{if(b=="xls"||b=="xlsx"){c+="xls.gif"}else{if(b=="ppt"||b=="pptx"){c+="ppt.gif"}else{if(b=="pdf"||b=="txt"||b=="hwp"||b=="zip"||b=="alz"||b=="mp3"||b=="wav"||b=="avi"||b=="mpeg"||b=="wmv"||b=="swf"||b=="html"||b=="map"){c+=b+".gif"}else{c+="etc.gif"}}}}}}this.elements.previewImg.src=c},setSelectedList:function(e,f){var d=this.getFileList();if(f=="ctrl"){if(e.isSelected){e.isSelected=false;daum.Element.removeClassName(e,"selected")}else{e.isSelected=true;daum.Element.addClassName(e,"selected")}}else{if(f=="shift"){var b=this.elements.clickedList;var g=b.index;var a=e.index;if(g>a){var c=a;a=g;g=c;b=e}while(b&&b.index<=a){if(!b.isSelected){b.isSelected=true;daum.Element.addClassName(b,"selected")}b=daum.Element.getNext(b)}}else{daum.Array.each(d,function(h){daum.Element.removeClassName(h,"selected");h.isSelected=false});e.isSelected=true;daum.Element.addClassName(e,"selected")}}this.elements.clickedList=e},appendFile:function(a){Editor.getSidebar().getAttachments()[a].execAppend()},deleteFile:function(h,c,f){if(f){daum.Event.preventDefault(f)}var a=T.admin.Editor.Util;var i=this;var d=this.elements.deleteFiles;var g="";var b=this.getFileList();if(b.length==0){return}if(h){g="첨부된 파일을 모두 삭제하시겠습니까?<br />삭제하시면 본문에서도 삭제됩니다."}else{g="삭제하시면 본문에서도 삭제됩니다.<br />계속하시겠습니까?"}T.Dialog.show("alertDeleteFile",{message:'<p class="txt_link">'+g+"</p>",buttons:[{ok:function(){this.close();if(h){daum.Array.each(b,function(n){if(n.name.indexOf("emap")==-1){d.push(n.name)}});i.elements.wrapFileList.innerHTML="";var j=Editor.getSidebar().getAttachments();var e=j.length;for(var m=0;m<e;m++){if(!j[m].deletedMark){Editor.getSidebar().getAttachments()[m].execRemove()}}i.elements.thumbImage="";daum.Element.hide(i.elements.wrapFileList)}else{var k=c.index;d.push(c.name);i.elements.wrapFileList.removeChild(c);Editor.getSidebar().getAttachments()[k].execRemove();if(c.imgSrc==i.elements.thumbImage){b=i.getFileList();for(var m=0,e=b.length;m<e;m++){var l=b[m];if(l.fileType=="image"||l.fileType=="movie"){i.elements.thumbImage=l.imgSrc;break}}}}i.elements.previewImg.src="http://i1.daumcdn.net/cfs.tistory/static/admin/editor/renew/sicon_org.gif";daum.Element.hide(i.elements.wrapThumbImgCheckbox);if(i.getFileList().length==0){daum.Element.hide(i.elements.wrapFileList)}},cancel:function(){this.close()}}]})},addFileforLayout:function(k){daum.Event.preventDefault(k);var h=this.editor.Util;var l=daum.Event.getElement(k);var n=[];var g=null;var c="";var b=daum.$$("#ttEditEntry input[name=contentWidth]")[0].value;var j=this;var r=this.getSelectedList();daum.Array.each(r,function(e){if(!Editor.getSidebar().getAttachments()[e.index].deletedMark){n.push(e.index)}}.bind(this));var q=n.length;if(daum.Element.hasClassName(l,"btn_filelayout_two")||daum.Element.hasClassName(l,"btn_filelayout_three")){if((daum.Element.hasClassName(l,"btn_filelayout_two")&&q==2)||(daum.Element.hasClassName(l,"btn_filelayout_three")&&q==3)){var m=true;var p=parseInt(b/q);for(var f=0;f<q;f++){var g=Editor.getSidebar().getAttachments()[n[f]];var o=parseInt(p*(g.data.actualheight/g.data.actualwidth));if(g.type=="image"){var d=g.dispHtml;d=d.replace("<img ",'<img actualwidth="'+p+'" actualheight="'+o+'" width="'+p+'" height="'+o+'"');c+="<td>"+d+"</td>"}else{m=false}}if(m){Editor.getCanvas().pasteContent('<table cellspacing="5" cellpadding="0" border="0" align="center"><tbody><tr>'+c+"</tr></tbody></table>",true,{style:{textAlign:"center"}})}else{T.Dialog.show("emptyTitle",{message:'<p class="txt_link">이미지 형식의 파일만 가능합니다.</p>',buttons:[{ok:function(){this.close()}}]})}}else{T.Dialog.show("emptyTitle",{message:'<p class="txt_link">파일의 갯수가 맞지 않습니다.</p>',buttons:[{ok:function(){this.close()}}]})}}else{if(daum.Element.hasClassName(l,"btn_filelayout_slideshow")&&q>0){var a=this.makeAttachFiles("image");if(!!a){this.editor.getAttachment().execAttach("slideshow",{key:"OBJECT_"+h.getRandomKey(),files:daum.Array.map(a,function(e){return[e[0],e[1]]})},"gallery")}else{T.Dialog.show("selectImageFile",{message:'<p class="txt_link">이미지 파일을 선택해 주세요.</p>',buttons:[{ok:function(){this.close()}}]})}}else{if(daum.Element.hasClassName(l,"btn_filelayout_audio")&&q>0){var a=this.makeAttachFiles("mp3");if(!!a){this.editor.getAttachment().execAttach("jukebox",{key:"OBJECT_"+h.getRandomKey(),files:a,autoplay:0})}else{T.Dialog.show("selecteMP3File",{message:'<p class="txt_link">MP3 파일을 선택해 주세요.</p>',buttons:[{ok:function(){this.close()}}]})}}else{daum.Array.each(r,function(i){var e=i.index;g=Editor.getSidebar().getAttachments()[e];if(!g.deletedMark){if(daum.Element.hasClassName(l,"btn_filelayout_inline")){g.data.imagealign="L"}else{if(daum.Element.hasClassName(l,"btn_filelayout_center")){g.data.imagealign="C"}else{if(daum.Element.hasClassName(l,"btn_filelayout_left")){g.data.imagealign="FL"}else{if(daum.Element.hasClassName(l,"btn_filelayout_right")){g.data.imagealign="FR"}else{return}}}}g.refreshProperties();g.execAppend()}}.bind(this))}}}},makeAttachFiles:function(d){var f=[];var g=this.getSelectedList();for(var c=0,a=g.length;c<a;c++){var e=g[c];if(e.fileType==d){var b=[this.editor.Util.ufConvert({attachurl:e.attachurl,filename:e.label}),e.label];f.push(b);this.editor.getAttachment().registFile(e)}else{return false}}return f},getFileList:function(){return daum.$$("li",this.elements.wrapFileList)},getSelectedList:function(){return daum.$$("li.selected",this.elements.wrapFileList)}};T.admin.Editor.PanelFileBox.Attachments={editor:T.admin.Editor,ATTACHMENT_NAMES:["Picture","Audio","Video","FlashSlide","ImageSlide"],MATCHED_NAMES:{image:"Picture",jukebox:"Audio",movie:"Video",imazing:"FlashSlide",gallery:"ImageSlide"},elements:{sidebarOption:daum.$("wrapOption"),sidebarAttach:daum.$("wrapAttach")},init:function(a){var b=this;daum.Array.each(this.ATTACHMENT_NAMES,function(d){this.getAttachment(d).init(a,this);var c=b.getAttachment(d).elements.panel;var e=daum.$$(".btn_multimediaok",c)[0];var f=daum.$$(".btn_multimediano",c)[0];if(!daum.Event.hasObserver(e,"click")&&!daum.Event.hasObserver(f,"click")){daum.Event.addEvent(e,"click",this.applyAdditionalInfo.bind(b,d));daum.Event.addEvent(f,"click",this.cancel.bind(b,d))}}.bind(this))},getAttachment:function(a){return this[a]},open:function(a,c){this.close();if(c===null){this.elements.preSelected=null}else{if(this.elements.preSelected=="Picture"||this.elements.preSelected=="FlashSlide"||this.elements.preSelected=="ImageSlide"){var b=this.elements.preSelected;if((this.elements.ElemWidth!=daum.$("attach"+b+"Width").value)||(this.elements.ElemHeight!=daum.$("attach"+b+"Height").value)){this.cancel(b)}else{this.getAttachment(b).elements.oldWidth=a.width;this.getAttachment(b).elements.oldHeight=a.height;this.getAttachment(b).elements.obj.refreshProperties()}}}if(a.width!=undefined&&a.height!=undefined){this.elements.ElemWidth=a.width;this.elements.ElemHeight=a.height}if(c==null){return}daum.Element.hide(this.elements.sidebarOption);daum.Element.show(this.elements.sidebarAttach);this.elements.preSelected=this.MATCHED_NAMES[c.type];this.getAttachment(this.MATCHED_NAMES[c.type]).clickHandler(a,c)},applyAdditionalInfo:function(a,b){this.getAttachment(a).applyInfo();if(a!="Video"){this.close()}},cancel:function(a,c){var b=a||this.elements.preSelected;if(b){this.getAttachment(b).cancel()}this.close()},close:function(a){var b=this;daum.Array.each(this.ATTACHMENT_NAMES,function(c){daum.Element.hide(b.getAttachment(c).elements.panel)});daum.Element.hide(this.elements.sidebarAttach);daum.Element.show(this.elements.sidebarOption)},makeFileList:function(f,a){var e=this.elements;var h=e.obj.data;var c;for(var d=0;d<a;d++){if(f=="audio"){c=h.files[d][1]}else{if(f=="imazing"||f=="gallery"){var b=h.files[d][0];c=h.files[d][1]||this.editor.getAttachment().getFileLabel(b)}}var g=this.templates.list.toElement({text:daum.String.escapeHTML(daum.String.cutString(c,28,".."))});if(!!b){g.imgSrc=this.editor.Util.getFileImage(b)}g.name=h.files[d][1];g.idx=d;g.deletedMark=false;e.wrapList.appendChild(g);daum.Event.addEvent(g,"click",this.attachment.clickFileList.bind(this,f,g));if(daum.Browser.ie6){daum.Event.addEvent(g,"mouseover",this.editor.Util.hoverFileList.bind(this,g,"over"));daum.Event.addEvent(g,"mouseout",this.editor.Util.hoverFileList.bind(this,g,"out"))}}},clickFileList:function(c,d,g){daum.Event.preventDefault(g);var f=daum.Event.getElement(g);var b=this.elements;if(!!b.selectedList){daum.Element.removeClassName(b.selectedList,"hover")}daum.Element.addClassName(d,"hover");b.selectedList=d;if(c=="audio"&&daum.Element.hasClassName(f,"txt")){var a=this.templates.nameInput.toElement({text:daum.String.escapeHTML(f.innerHTML)});f.parentNode.appendChild(a);a.focus();daum.Element.hide(f);daum.Event.addEvent(a,"blur",this.modifyFileName.bind(this,f));daum.Event.addEvent(a,"keydown",this.modifyFileName.bind(this,f))}else{if(c=="imazing"){daum.Element.show(b.wrapPreviewImgElem);daum.$$("img",b.wrapPreviewImgElem)[0].src=d.imgSrc}else{if(c=="gallery"){b.captionElem.disabled=false;b.captionElem.value=b.oldImageList[b.selectedList.idx]["caption"];daum.Element.show(b.wrapPreviewImgElem);daum.$$("img",b.wrapPreviewImgElem)[0].src=d.imgSrc}}}if(daum.Element.hasClassName(f,"btn_imgdelete")){T.Dialog.show("confirmRemoveImage",{message:'<p class="txt_link">파일을 삭제하시겠습니까?</p>',buttons:[{ok:function(){this.close();d.deletedMark=true;daum.Element.hide(d);daum.Element.hide(daum.$("wrapFlashslidePreviewImg"));daum.Element.hide(daum.$("wrapImageslidePreviewImg"));daum.$("attachImageSlideCaption").value=""}},{cancel:function(){this.close()}}]})}else{if(daum.Element.hasClassName(f,"btn_imgup")){this.attachment.changeFileOrder(f.parentNode.parentNode,"up")}else{if(daum.Element.hasClassName(f,"btn_imgdown")){this.attachment.changeFileOrder(f.parentNode.parentNode,"down")}}}},changeFileOrder:function(b,a){if(a=="up"){if(!!daum.Element.getPrev(b)){b.parentNode.insertBefore(b,daum.Element.getPrev(b))}}else{if(!!daum.Element.getNext(b)){b.parentNode.insertBefore(daum.Element.getNext(b),b)}}},deleteFile:function(f,g,c){var b=T.admin.Editor.Util;var d=this.editor;var h=daum.$$("#ttEditEntry input[name=id]")[0].value;if(g){var e=daum.$(c);var a=e.index;d.PanelFileBox.elements.wrapFileList.removeChild(e);Editor.getSidebar().getAttachments()[a].execRemove();d.PanelFileBox.elements.fileList[a]=null;d.PanelFileBox.elements.fileList=daum.Array.compact(d.PanelFileBox.elements.fileList);if(daum.$$("#fileList li").length==0){daum.Element.hide(d.PanelFileBox.elements.wrapFileList)}}},resize:function(b,f,i){var c=this.elements;var h=daum.Event.getElement(i);var g=h.value;if(f=="image"){if(/[0-9]/g.test(g)){if(b=="width"){var a=Math.round(g*c.reverseratio);c.heightElem.value=a;daum.Element.setStyle(c.elem,"width:"+g+"px;height:"+a+"px")}else{var d=Math.round(g*c.ratio);c.widthElem.value=d;daum.Element.setStyle(c.elem,"width:"+d+"px;height:"+g+"px")}}}else{if(/[0-9]/g.test(h.value)){c.elem.style[b]=h.value;c[b]=h.value}}}};T.admin.Editor.PanelFileBox.Attachments.Picture={elements:{panel:daum.$("panelAttachPicture"),widthElem:daum.$("attachPictureWidth"),heightElem:daum.$("attachPictureHeight"),altElem:daum.$("attachPictureAlt"),captionElem:daum.$("attachPictureCaption")},init:function(b,a){this.editor=b;this.attachment=a;daum.Event.addEvent(this.elements.widthElem,"keyup",this.attachment.resize.bind(this,"width","image"));daum.Event.addEvent(this.elements.heightElem,"keyup",this.attachment.resize.bind(this,"height","image"))},clickHandler:function(b,d){var a=this.elements;a.elem=b;a.obj=d;var c=d.data;a.oldWidth=a.widthElem.value=(!b.style.width)?b.width:parseInt(b.style.width);a.oldHeight=a.heightElem.value=(!b.style.height)?b.height:parseInt(b.style.height);a.altElem.value=(!c.alt)?"":c.alt;a.captionElem.value=(!c.caption)?"":c.caption;a.ratio=a.oldWidth/a.oldHeight;a.reverseratio=a.oldHeight/a.oldWidth;daum.Element.show(a.panel)},applyInfo:function(){var a=this.elements;var b=a.obj.data;b.alt=a.altElem.value;b.caption=a.captionElem.value;a.obj.refreshProperties()},cancel:function(){var a=this.elements;a.elem.style.width=a.oldWidth;a.elem.style.height=a.oldHeight}};T.admin.Editor.PanelFileBox.Attachments.Audio={templates:{list:new daum.Template('<li><span class="txt">#{text}</span><span class="btn"><a class="btn_comm btn_imgdelete" href="#">삭제</a><a class="btn_comm btn_imgup" href="#">위로</a><a class="btn_comm btn_imgdown" href="#">아래로</a></span></li>'),nameInput:new daum.Template('<input type="text" value="#{text}" class="filename_input">')},elements:{panel:daum.$("panelAttachAudio"),autoplayElem:daum.$("attachAudioAutoplay"),audioHiddenElem:daum.$("attachAudioHidden")},init:function(b,a){this.editor=b;this.attachment=a;this.elements.wrapList=daum.$$(".list_audio",this.elements.panel)[0]},clickHandler:function(c,e){var b=this.elements;b.obj=e;b.elem=c;var d=e.data;var f=d.files.length;b.oldAudioList=[];for(var a=0;a<f;a++){b.oldAudioList.push({name:d.files[a][0],file:d.files[a][1]})}b.wrapList.innerHTML="";b.autoplayElem.checked=(d.autoplay==0)?false:true;b.audioHiddenElem.checked=(d.visible!=undefined&&d.visible==0)?true:false;daum.Element.show(b.panel);this.attachment.makeFileList.bind(this,"audio",f)()},applyInfo:function(){var c=this.elements;var g=c.obj.data;var f=[];var h=false;g.autoplay=(c.autoplayElem.checked)?1:0;g.visible=(c.audioHiddenElem.checked)?0:1;var e=daum.$$("li",c.wrapList);var d=e.length;c.obj.data.files=[];for(var b=0;b<d;b++){if(e[b].deletedMark){f.push(e[b].name)}else{var a=e[b].idx;g.files.push([c.oldAudioList[a]["name"],c.oldAudioList[a]["file"]])}}c.obj.refreshProperties();if(d==f.length){h=true}this.attachment.deleteFile.bind(this,f,h,g.key)()},cancel:function(){},modifyFileName:function(b,d){if(d.type=="blur"||d.keyCode==13){var c=daum.Event.getElement(d);var f=c.parentNode;var a=c.value;c.parentNode.removeChild(c);b.innerHTML=daum.String.escape(a);daum.Element.show(b);this.elements.oldAudioList[f.idx]["file"]=a}}};T.admin.Editor.PanelFileBox.Attachments.Video={elements:{panel:daum.$("panelAttachVideo"),title:daum.$("attachVideoTitle"),playtime:daum.$("playTime"),isvideopublic:daum.$F("isvideopublic"),category:daum.$("movieCategory"),attachVideoPublic:daum.$("attachVideoPublic"),attachVideoNonPublic:daum.$("attachVideoNonPublic"),attachVideoShare:daum.$("attachVideoShare"),attachVideoNonShare:daum.$("attachVideoNonShare")},init:function(b,a){this.editor=b;this.attachment=a;daum.Event.addEvent(this.elements.attachVideoPublic,"click",this.selectPublicOption.bind(this,"public"));daum.Event.addEvent(this.elements.attachVideoNonPublic,"click",this.selectPublicOption.bind(this,"nonpublic"))},selectPublicOption:function(b,c){var a=this.elements;if(b==="public"){a.attachVideoPublic.checked=true;a.attachVideoShare.disabled=false;a.attachVideoNonShare.disabled=false}else{a.attachVideoNonPublic.checked=true}},clickHandler:function(e,g){var a=T.admin.Editor.Util;var c=this.elements;c.obj=g;c.elem=e;var f=g.data;c.title.value=f.title;c.category.value=f.moviecate;if(f.allowcopy.toString()==="true"){c.attachVideoShare.checked=true}else{c.attachVideoNonShare.checked=true}if(f.movieopen.toString()==="true"){this.selectPublicOption("public")}else{this.selectPublicOption("nonpublic")}var b=parseInt(f.playtime/60);var d=f.playtime%60;d=(d<10)?"0"+d:d;c.playtime.innerHTML=b+":"+d;daum.Element.show(c.panel)},applyInfo:function(){var a=this.elements;var b=a.obj.data;b.title=a.title.value.trim();b.allowcopy=(a.attachVideoShare.checked)?"true":"false";if(a.attachVideoPublic.checked){if(a.category.value=="0"){T.Dialog.show("emptyTvpotCategory",{message:'<p class="txt_link">카테고리를 선택해 주세요.</p>',buttons:[{ok:function(){this.close()}}]});return}else{b.moviecate=a.category.value;b.movieopen="true"}}else{b.moviecate=a.category.value;b.movieopen="false"}a.obj.refreshProperties();this.attachment.close()},cancel:function(){}};T.admin.Editor.PanelFileBox.Attachments.FlashSlide={templates:{list:new daum.Template('<li><span class="txt">#{text}</span><span class="btn"><a class="btn_comm btn_imgdelete" href="#">삭제</a><a class="btn_comm btn_imgup" href="#">위로</a><a class="btn_comm btn_imgdown" href="#">아래로</a></span></li>')},elements:{panel:daum.$("panelAttachFlashSlide"),widthElem:daum.$("attachFlashSlideWidth"),heightElem:daum.$("attachFlashSlideHeight"),changeSceneElem:daum.$("attachFlashSlideChangescene"),navigationElem:daum.$("attachFlashSlideNavigation"),intervalElem:daum.$("attachFlashSlideInterval"),frameElem:daum.$("attachFlashSlideFrame"),alignElem:daum.$("attachFlashSlideSort"),wrapPreviewImgElem:daum.$("wrapFlashslidePreviewImg")},init:function(b,a){this.editor=b;this.attachment=a;this.elements.wrapList=daum.$$(".list_img",this.elements.panel)[0];daum.Event.addEvent(this.elements.widthElem,"keyup",this.attachment.resize.bind(this,"width","imazing"));daum.Event.addEvent(this.elements.heightElem,"keyup",this.attachment.resize.bind(this,"height","imazing"))},clickHandler:function(c,e){var b=this.elements;b.obj=e;b.elem=c;var d=e.data;var f=d.files.length;b.oldImageList=[];for(var a=0;a<f;a++){b.oldImageList.push({caption:d.files[a][0],file:d.files[a][1]})}b.wrapList.innerHTML="";b.oldWidth=b.widthElem.value=(!c.style.width)?c.width:parseInt(c.style.width);b.oldHeight=b.heightElem.value=(!c.style.height)?c.height:parseInt(c.style.height);b.changeSceneElem.value=(!d.transition)?"net_imazing_show_window_transition_alpha":d.transition;b.navigationElem.value=(!d.navigation)?"net_imazing_show_window_navigation_simple":d.navigation;b.intervalElem.value=(!d.slideshowInterval)?"10":d.slideshowInterval;b.frameElem.value=(!d.page)?"1":d.page;b.alignElem.value=(!d.align)?"h":d.align;daum.Element.hide(b.wrapPreviewImgElem);daum.$$("img",b.wrapPreviewImgElem)[0].src="";daum.Element.show(b.panel);this.attachment.makeFileList.bind(this,"imazing",f)()},applyInfo:function(){var e=this.elements;var f=e.obj.data;var c=[];var a=false;if(/[0-9]/g.test(e.widthElem.value)){f.width=e.widthElem.value;e.oldWidth=f.width}if(/[0-9]/g.test(e.heightElem.value)){f.height=e.heightElem.value;e.oldHeight=f.height}f.transition=e.changeSceneElem.value;f.navigation=e.navigationElem.value;if(/[0-9]/g.test(e.intervalElem.value)){f.slideshowInterval=e.intervalElem.value}if(/[0-9]/g.test(e.frameElem.value)){f.page=e.frameElem.value}f.align=e.alignElem.value;var b=daum.$$("li",e.wrapList);var d=b.length;f.files=[];for(var g=0;g<d;g++){if(b[g].deletedMark){c.push(b[g].name)}else{var j=b[g].idx;var h=e.oldImageList[j];f.files.push([h.caption,h.file])}}e.obj.refreshProperties();if(d==c.length){a=true}this.attachment.deleteFile.bind(this,c,a,f.key)()},cancel:function(){var a=this.elements;a.elem.width=a.elem.style.width=a.oldWidth;a.elem.height=a.elem.style.height=a.oldHeight}};T.admin.Editor.PanelFileBox.Attachments.ImageSlide={templates:{list:new daum.Template('<li><span class="txt">#{text}</span><span class="btn"><a class="btn_comm btn_imgdelete" href="#">삭제</a><a class="btn_comm btn_imgup" href="#">위로</a><a class="btn_comm btn_imgdown" href="#">아래로</a></span></li>')},elements:{panel:daum.$("panelAttachImageSlide"),widthElem:daum.$("attachImageSlideWidth"),heightElem:daum.$("attachImageSlideHeight"),captionElem:daum.$("attachImageSlideCaption"),wrapPreviewImgElem:daum.$("wrapImageslidePreviewImg")},init:function(c,a){this.editor=c;this.attachment=a;var b=this.elements;b.wrapList=daum.$$(".list_img",b.panel)[0];daum.Event.addEvent(b.widthElem,"keyup",this.attachment.resize.bind(this,"width","gallery"));daum.Event.addEvent(b.heightElem,"keyup",this.attachment.resize.bind(this,"height","gallery"));daum.Event.addEvent(b.captionElem,"focus",this.addCaption.bind(this));daum.Event.addEvent(b.captionElem,"blur",this.addCaption.bind(this))},addCaption:function(a){this.elements.oldImageList[this.elements.selectedList.idx]["caption"]=this.elements.captionElem.value},clickHandler:function(c,e){var b=this.elements;b.obj=e;b.elem=c;var d=e.data;var f=d.files.length;b.oldImageList=[];for(var a=0;a<f;a++){b.oldImageList.push({caption:d.files[a][1],file:d.files[a][0]})}b.wrapList.innerHTML="";b.oldWidth=b.widthElem.value=(!c.style.width)?c.width:parseInt(c.style.width);b.oldHeight=b.heightElem.value=(!c.style.height)?c.height:parseInt(c.style.height);b.captionElem.value="파일을 선택하면 자막을 입력할 수 있습니다.";b.captionElem.disabled=true;daum.Element.hide(b.wrapPreviewImgElem);daum.$$("img",b.wrapPreviewImgElem)[0].src="";daum.Element.show(b.panel);this.attachment.makeFileList.bind(this,"gallery",f)()},applyInfo:function(){var e=this.elements;var f=e.obj.data;var c=[];var a=false;if(/[0-9]/g.test(e.widthElem.value)){f.width=e.widthElem.value;e.oldWidth=f.width}if(/[0-9]/g.test(e.heightElem.value)){f.height=e.heightElem.value;e.oldHeight=f.height}f.caption=(e.captionElem.value).trim().replace(/\\s+/g," ");var b=daum.$$("li",e.wrapList);var d=b.length;f.files=[];for(var g=0;g<d;g++){if(b[g].deletedMark){c.push(b[g].name)}else{var j=b[g].idx;var h=e.oldImageList[j];f.files.push([h.file,h.caption])}}e.obj.refreshProperties();if(d==c.length){a=true}this.attachment.deleteFile.bind(this,c,a,f.key)()},cancel:function(){var a=this.elements;a.elem.width=a.elem.style.width=a.oldWidth;a.elem.height=a.elem.style.height=a.oldHeight}};
T.admin.Editor.PanelTag={elements:{panel:daum.$("panelTagAndLocation"),tagInput:daum.$("tagInput"),tagList:daum.$("tagList"),btnRecommendTag:daum.$("btnRecommendTag"),layer:null,tagBox:null},templates:{tagItem:'<a href="javascript:;" title="${tag}"><span>${tag}</span><img src="http://i1.daumcdn.net/cfs.tistory/static/admin/form/s.gif" width="12" height="12" class="btn_comm btn_imgdelete" alt="삭제" /></a>',layer:'<div class="tag_balloon"><div class="wrap_tag_list"></div><a href="javascript:;" title="닫기"><img src="http://i1.daumcdn.net/cfs.tistory/static/admin/form/s.gif" class="btn_comm btn_filedelete" width="15" height="15" alt="닫기" /></a></div>',list:'<span class="balloon_tail"></span><ul class="tag_list">{for item in items}<li><a href="javascript:;" title="${item}">${item}</a></li>{/for}</ul>',msg:'<span class="balloon_tail"></span><span class="message">${msg}</span>'},messages:{NO_TAGS:"작성된 태그가 없습니다."},attributes:{tags:[],siteTags:null,tagBoxWidth:0,layerWidth:0},init:function(d){this.editor=d;var b=this.elements.panel;var c=this.elements.tagInput;var a=c.value;daum.Event.addEvent(c,"focus",function(g){var f=daum.Event.getElement(g);daum.Element.addClassName(f,"activity");if(daum.Element.hasClassName(c,"empty-text")){daum.Element.removeClassName(c,"empty-text");f.value=""}});daum.Event.addEvent(c,"blur",function(h){var g=daum.Event.getElement(h);daum.Element.removeClassName(g,"activity");var f=g.value.trim();if(f!=""){this.addTag(f)}daum.Element.addClassName(c,"empty-text");g.value=a}.bind(this));this.createLayer();var e=daum.Element.getCoords(this.elements.tagList);this.attributes.tagBoxWidth=e.right-e.left;daum.Event.addEvent(this.elements.tagList,"click",function(g){daum.Event.stopEvent(g);var f=daum.Event.getElement(g);if(daum.Element.hasClassName(f,"btn_imgdelete")){f=daum.Element.getParent(f);this.removeTag(f)}else{if(f.tagName.toLowerCase()=="span"){f=daum.Element.getParent(f);this.editTag(f)}}}.bind(this));daum.Event.addEvent(this.elements.btnRecommendTag,"click",this.openLayer.bind(this));this.initSuggest()},initSuggest:function(){var a=this.elements.tagInput;var b=new T.admin.Suggest({input:a,selectedClassName:"tag_suggest_selected",url:"/admin/entry/post/proxyTags.php",key:"query",parse:function(d){var c=[];if(daum.Object.isArray(d.data.tags)){daum.Array.each(d.data.tags,function(e){c.push(e[0])})}return c},callback:function(c){if(!!c&&daum.Object.isString(c)){c=daum.String.trim(c)}else{c=daum.String.trim(a.value)}if(c!==""){if(c.indexOf(",")>-1){daum.Array.each(c.split(","),function(d){var d=daum.String.trim(d);if(d!==""){this.addTag(d)}}.bind(this))}else{this.addTag(c)}}a.value=""}.bind(this)});daum.Event.addEvent(daum.$("mAside"),"scroll",function(c){b.clear()})},createLayer:function(){var a=daum.createElement(this.getHtml("layer"));document.body.appendChild(a);this.elements.layer=a;this.elements.tagBox=daum.$$("div.wrap_tag_list",a)[0];daum.Element.show(a);coords=daum.Element.getCoords(this.elements.tagBox);this.attributes.layerWidth=coords.right-coords.left;daum.Element.hide(a);daum.Event.addEvent(a,"click",function(d){daum.Event.stopEvent(d);var c=daum.Event.getElement(d);if(daum.Element.hasClassName(c,"btn_filedelete")){daum.Element.hide(this.elements.layer)}else{if(c.tagName.toLowerCase()=="a"){var b=c.getAttribute("title");this.addTag(b);daum.Element.destroy(daum.Element.getParent(c));if(daum.$$("li",this.elements.tagBox).size()==0){daum.Element.hide(this.elements.layer)}}}}.bind(this));daum.Event.addEvent(daum.$("mAside"),"scroll",function(b){daum.Element.hide(this.elements.layer)}.bind(this));daum.Event.addEvent(document,"click",function(b){daum.Element.hide(this.elements.layer)}.bind(this));daum.Event.addEvent(window,"resize",function(b){daum.Element.hide(this.elements.layer)}.bind(this));Editor.getCanvas().observeJob(Trex.Ev.__CANVAS_PANEL_CLICK,function(b){daum.Element.hide(this.elements.layer)}.bind(this));Editor.getCanvas().observeJob("tistory.attachment.custom.clicked",function(b){daum.Element.hide(this.elements.layer)}.bind(this))},openLayer:function(d){daum.Event.stopEvent(d);if(!this.elements.layer){this.createLayer()}var c=daum.Element.getCoords(this.elements.btnRecommendTag);var b=0;var a=daum.Element.getParent(this.elements.btnRecommendTag);while(a!==document.body){b+=a.scrollTop;a=daum.Element.getParent(a)}daum.Element.show(this.elements.layer);daum.Element.setPosition(this.elements.layer,(c.right-this.attributes.layerWidth+3),c.bottom-b);var f=this.editor.getEntry().getSiteTags();if(f.length>0){this.elements.tagBox.innerHTML=this.getHtml("list",{items:f})}else{this.elements.tagBox.innerHTML=this.getHtml("msg",{msg:this.messages.NO_TAGS})}},addTag:function(d){if(this.editor.getEntry().hasTag(d)){this.flashTag(d);return daum.$$("a[title="+d+"]",this.elements.tagList)[0]}this.editor.getEntry().addTag(d);var b=daum.createElement(this.getHtml("tagItem",{tag:d}));this.elements.tagList.appendChild(b);this.elements.tagList.appendChild(document.createTextNode("\n"));var c=daum.Element.getCoords(b);var a=c.right-c.left;if(a>this.attributes.tagBoxWidth){daum.Element.setStyle(b,"word-break:break-all;white-space:normal;")}return b},removeTag:function(a){var b=a.getAttribute("title");daum.Element.destroy(a);this.editor.getEntry().removeTag(b)},editTag:function(b){var a=this.elements.tagInput;daum.Element.removeClassName(a,"empty-text");a.value=b.getAttribute("title");a.focus();this.removeTag(b)},flashTag:function(b){var a=daum.$$("a[title="+b+"]",this.elements.tagList)[0];daum.Element.setStyle(a,"background-color:#ff0;");daum.Fx.animate(a,"background-color:#fff;",{duration:2,callback:function(c){daum.Element.setStyle(a,"background-color:transparent;")}})},getHtml:function(a,c){var b=this.templates;if(!b.hasOwnProperty(a)){return null}if(daum.Object.isString(b[a])){b[a]=TrimPath.parseTemplate(b[a])}return b[a].process(c)}};
T.admin.Editor.PanelLocation={editor:T.admin.Editor,elements:{locationSearch:daum.$("locationSearch"),locationSearchBtn:daum.$("locationSearchBtn"),locationSearchWrap:daum.$("locationSearchWrap"),locationFieldWrap:daum.$("locationFieldWrap"),locationSelectWrap:daum.$("locationSelectWrap"),locationSelect:daum.$("locationSelect"),domesticLocation:daum.$("domesticLocation"),foreignLocation:daum.$("foreignLocation"),selectDomesticLocation:daum.$("selectDomesticLocation"),selectForeignLocation:daum.$("selectForeignLocation"),continentLocation:daum.$("continentForLocationTag"),nationLocation:daum.$("nationForLocationTag"),cityLocation:daum.$("cityForLocationTag")},templates:{locationItem:'<span data-index="${index}" class="txt">${label} <a href="javascript:;"><img data-index="${index}" src="http://i1.daumcdn.net/cfs.tistory/static/admin/form/s.gif" class="btn_comm btn_filedelete" width="15" height="15" alt="삭제" /></a></span>',locationSelect:'<option value="${index}" title="${label}">${shortlabel}</option>'},openedWindow:null,init:function(){var b=this.elements.locationSearch;var a=b.value;daum.Event.addEvent(b,"focus",function(d){var c=daum.Event.getElement(d);daum.Element.addClassName(c,"activity");if(daum.Element.hasClassName(c,"empty-text")){c.value=""}});daum.Event.addEvent(b,"blur",function(d){var c=daum.Event.getElement(d);daum.Element.removeClassName(c,"activity");if(c.value.trim()==""){c.value=a;daum.Element.addClassName(c,"empty-text")}else{daum.Element.removeClassName(c,"empty-text")}});daum.Event.addEvent(b,"keydown",function(c){if(c.keyCode==13){if(target.value.trim()==""){target.value=a}else{daum.Element.removeClassName(target,"empty-text")}this.popupLocationSearch()}}.bind(this));daum.Event.addEvent(this.elements.locationSearchBtn,"click",this.popupLocationSearch.bind(this));daum.Event.addEvent(this.elements.locationFieldWrap,"click",this.removeItemByButton.bind(this));daum.Event.addEvent(this.elements.locationSelect,"change",this.onChangeSelect.bind(this));daum.Event.addEvent(this.elements.domesticLocation,"click",this.setDomesticOrForeign.bind(this));daum.Event.addEvent(this.elements.foreignLocation,"click",this.setDomesticOrForeign.bind(this));daum.Event.addEvent(this.elements.continentLocation,"change",this.selectForeignLocation.bind(this,"continent"));daum.Event.addEvent(this.elements.nationLocation,"change",this.selectForeignLocation.bind(this,"nation"));daum.Event.addEvent(this.elements.cityLocation,"change",this.selectForeignLocation.bind(this,"city"));Editor.getAttachBox().observeJob(Trex.Ev.__ENTRYBOX_ENTRY_ADDED,this.addItemByEditor.bind(this));Editor.getAttachBox().observeJob(Trex.Ev.__ENTRYBOX_ENTRY_REMOVED,this.removeItemByEditor.bind(this));Editor.observeJob(Trex.Ev.__PASTE_SEARCHRESULT,function(e,d,c,f){if(e==="restaurant"||e==="travel"){this.addItemBySearch(f)}}.bind(this))},getParam:function(){var a={};a.isKorea=this.elements.domesticLocation.checked;return a},popupLocationSearch:function(d){if(d){daum.Event.preventDefault(d)}var b=this.elements.locationSearch;var c=daum.String.trim(b.value);if(daum.Element.hasClassName(b,"empty-text")||c==""){alert("장소/상호명을 입력해주세요.");if(daum.Browser.ie6){setTimeout(function(){b.focus()},0)}else{b.focus()}return}var f=location.protocol+"//"+location.host+"/admin/entry/post/attach.php?type=localtag";var a="http://attach.map.daum.net/?mode=B&appendType=S&target="+encodeURIComponent(f)+"&q="+encodeURIComponent(c);if(this.openedWindow&&daum.Browser.ie){this.openedWindow.close()}this.openedWindow=daum.Browser.popup(a,790,546,{name:"TistoryMapTag",scroll:0,resize:1,status:0})},addItemBySearch:function(b){b=this.convertWcongToCong(b,"search");var a=this.editor.getEntry().addLocalTag(T.cloneObject(b));this.addItem(b,a)},addItemByEditor:function(a){if(a.type!=="map"||!!a.data.alreadAttach){return}a.data=this.convertWcongToCong(a.data,"editor");this.addItem(a.data,a.data.dataSeq)},addItemWhenEditing:function(c,a){if(c.addtype==="1"){if(c.isdefault==="Y"){var b=function(d){if(d.addr!==c.addr){return false}if(d.mapX!==c.mapX){return false}if(d.mapY!==c.mapY){return false}if(d.rcode!==c.rcode){return false}if(d.title!==c.title){return false}return true};daum.Array.each(Editor.getAttachments(),function(d){if(d.attacher!=="map"){return}if(b(d.data)){daum.Array.each(daum.$$("option",this.elements.locationSelect),function(f,e){if(f.value!==d.data.dataSeq){return}this.editor.getEntry().setDefaultLocalTagIndex(f.value);this.elements.locationSelect.selectedIndex=e}.bind(this))}}.bind(this))}}else{a=this.editor.getEntry().addLocalTag(T.cloneObject(c))}this.addItem(c,a)},addItem:function(c,b){if(!daum.documentLoaded){daum.Function.timeout(this.addItem.bind(this,c,b),10);return}var a=(c.addr||c.address)+" | "+c.title;this.addFieldItem(b,a);this.addSelectItem(b,a);if(c.isdefault==="Y"){this.editor.getEntry().setDefaultLocalTagIndex(b);this.elements.locationSelect.selectedIndex=this.elements.locationSelect.length-1}if(this.editor.getEntry().getDefaultLocalTagIndex()===0){this.editor.getEntry().setDefaultLocalTagIndex(b);this.elements.locationSelect.selectedIndex=this.elements.locationSelect.length-1}if(this.getItemCount()===1){daum.Element.hide(this.elements.locationSearchWrap);daum.Element.show(this.elements.locationFieldWrap)}else{if(this.getItemCount()===2){daum.Element.show(this.elements.locationSelectWrap)}}this.refreshSelect()},refreshSelect:function(){var a=this.elements;var b=this.editor.getEntry().getDefaultLocalTagIndex().toString();daum.Array.each(daum.$$("option",a.locationSelect),function(d,c){if(d.value!==b){return}a.locationSelect.selectedIndex=c}.bind(this))},addFieldItem:function(b,a){var c=daum.createElement(this.getHtml("locationItem",{index:b,label:a}));this.elements.locationFieldWrap.insertBefore(c,daum.$$("div.line",this.elements.locationFieldWrap)[0])},addSelectItem:function(b,a){var d=daum.String.cutPixel(a,210,"...")||a;var c=daum.createElement(this.getHtml("locationSelect",{index:b,label:a,shortlabel:d}));this.elements.locationSelect.appendChild(c)},removeItemByButton:function(c){var b=daum.Event.getElement(c);if(daum.Element.hasClassName(b,"btn_filedelete")){daum.Event.preventDefault(c);var a=b.getAttribute("data-index");this.editor.getEntry().removeLocalTag(a);this.removeItem(a)}},removeItemByEditor:function(a){if(a.type!=="map"){return}var b=a.data;this.removeItem(b.dataSeq)},getFileList:function(){return daum.$$("li",T.admin.Editor.PanelFileBox.elements.wrapFileList)},removeAllItemByEditor:function(){var c=T.admin.Editor.Util;var f=T.admin.Editor.PanelFileBox.elements;var g=f.deleteFiles;var d=this.getFileList();if(d.length==0){return}daum.Array.each(d,function(h){if(h.name.indexOf("emap")==-1){g.push(h.name)}});f.wrapFileList.innerHTML="";var b=Editor.getSidebar().getAttachments();var a=b.length;for(var e=0;e<a;e++){if(!b[e].deletedMark){Editor.getSidebar().getAttachments()[e].execRemove()}}f.thumbImage="";daum.Element.hide(f.wrapFileList);f.previewImg.src="http://i1.daumcdn.net/cfs.tistory/static/admin/editor/renew/sicon_org.gif";daum.Element.hide(f.wrapThumbImgCheckbox);if(this.getFileList().length==0){daum.Element.hide(f.wrapFileList)}},removeItem:function(a){if(a>0){var b=this.editor.Attachment.getDataFromServer()["map"].data;if(b.length>a-1){b[a-1].deleteTag=true}var c=Editor.getSidebar().getAttachments();if(c[a-1]!=undefined){c[a-1].data.deleteTag=true;c[a-1].refreshProperties()}}this.removeFieldItem(a);this.removeSelectItem(a);if(this.getItemCount()===0){daum.Element.show(this.elements.locationSearchWrap);daum.Element.hide(this.elements.locationFieldWrap)}else{if(this.getItemCount()===1){daum.Element.hide(this.elements.locationSelectWrap)}}if(this.elements.locationSelect.value==""){this.editor.getEntry().setDefaultLocalTagIndex(0)}else{this.editor.getEntry().setDefaultLocalTagIndex(this.elements.locationSelect.value)}},removeFieldItem:function(a){if(daum.$$("span[data-index="+a+"]",this.elements.locationFieldWrap).length>0){var b=daum.$$("span[data-index="+a+"]",this.elements.locationFieldWrap)[0];daum.Element.destroy(b)}},removeSelectItem:function(a){if(daum.$$("option[value="+a+"]",this.elements.locationSelect).length>0){var b=daum.$$("option[value="+a+"]",this.elements.locationSelect)[0];daum.Element.destroy(b)}},onChangeSelect:function(b){var a=daum.Event.getElement(b);this.editor.getEntry().setDefaultLocalTagIndex(a.value)},getItemCount:function(){return daum.$$("span",this.elements.locationFieldWrap).length},getHtml:function(a,c){var b=this.templates;if(!b.hasOwnProperty(a)){return null}if(daum.Object.isString(b[a])){b[a]=TrimPath.parseTemplate(b[a])}return b[a].process(c)},setDomesticOrForeign:function(b,a){var c=this;if(b){var a=daum.Event.getElement(b)}if(a.id=="domesticLocation"){if(this.elements.continentLocation.value!=0||this.elements.nationLocation.value!=0||this.elements.cityLocation.value!=0){T.Dialog.show("noAllowChange",{message:'<p class="txt_link">세계 위치가 이미 선택되어 있습니다.<br />국내 위치를 선택한 후 저장하시면 세계 위치 정보는 삭제됩니다.</p>',buttons:[{ok:function(){this.close();daum.Element.show(c.elements.selectDomesticLocation);daum.Element.hide(c.elements.selectForeignLocation)},cancel:function(){this.close();daum.Event.stopEvent(b);c.elements.foreignLocation.checked=true}}]})}else{daum.Element.show(this.elements.selectDomesticLocation);daum.Element.hide(this.elements.selectForeignLocation)}}else{if(this.getItemCount()!==0){T.Dialog.show("noAllowChange",{message:'<p class="txt_link">국내 위치가 이미 선택되어 있습니다.<br />세계 위치를 선택한 후 저장하시면 국내 위치 정보는 삭제됩니다.</p>',buttons:[{ok:function(){this.close();daum.Element.hide(c.elements.selectDomesticLocation);daum.Element.show(c.elements.selectForeignLocation)},cancel:function(){this.close();daum.Event.stopEvent(b);c.elements.domesticLocation.checked=true}}]})}else{daum.Element.hide(this.elements.selectDomesticLocation);daum.Element.show(this.elements.selectForeignLocation)}}},selectForeignLocation:function(b,h){var g=daum.Event.getElement(h);var i=this;var f="";var c="";var a;var d=16;if(g.value==""){return}if(b=="continent"){this.elements.cityLocation.innerHTML='<option value="0">도시선택</option>';f="/admin/ajaxcall/searchRegionOfWorld.php?regionDepthNo=2&oneDepthId="+g.value;c=daum.createElement('<option value="0">국가선택</option>');a=this.elements.nationLocation}else{if(b=="nation"){f="/admin/ajaxcall/searchRegionOfWorld.php?regionDepthNo=3&oneDepthId="+this.elements.continentLocation.value+"&twoDepthId="+g.value;c=daum.createElement('<option value="0">도시선택</option>');a=this.elements.cityLocation}else{return}}this.editor.Util.sendRequest({url:f,method:"GET",onsuccess:function(j){var e=daum.jsonToObject(j.responseText);var k=document.createDocumentFragment();k.appendChild(c);daum.Array.each(e.regionData,function(l){k.appendChild(daum.createElement('<option title="'+l.name+'"value="'+l.id+'">'+daum.String.cutString(l.name,d,"..")+"</option>"))});a.innerHTML="";a.appendChild(k);if(daum.Browser.ie){a.selectedIndex=0}},onfailure:function(e){console.log(e)}})},convertWcongToCong:function(d,b){if(d.mapInfo){var f=daum.jsonToObject(d.mapInfo);if(f.coordinate=="wcongnamul"){var c=new TransCoordinator();var a=0,e=0;if(b=="search"&&f.markInfo.length>0){a=f.markInfo[0].x;e=f.markInfo[0].y}else{a=d.mapX;e=d.mapY}result=c.convertWCONGNAMUL2(a,e,4,null,null,null,null);d.mapX=result[0];d.mapY=result[1]}return d}}};
T.admin.Editor.PanelTrackback={elements:{trackback:daum.$("trackback")},init:function(){var a=this.elements.trackback;daum.Event.addEvent(a,"focus",function(c){var b=daum.Event.getElement(c);daum.Element.addClassName(b,"activity")});daum.Event.addEvent(a,"blur",function(c){var b=daum.Event.getElement(c);daum.Element.removeClassName(b,"activity")})},getParam:function(){var a={};a.trackback=this.elements.trackback.value;return a},getUrl:function(){var a=this.elements.trackback.value.trim();return(a==""||a=="http://")?null:a},clearUrl:function(){this.elements.trackback.value="http://"}};T.admin.Editor.PanelCCL={editor:null,elements:{panel:daum.$("panelCcl"),checkCCL:daum.$("ccl"),radioComUseY:daum.$("cclComUseY"),radioComUseN:daum.$("cclComUseN"),radioChgY:daum.$("cclChgY"),radioChgN:daum.$("cclChgN"),radioChgP:daum.$("cclChgP")},init:function(){daum.Event.addEvent(this.elements.panel,"click",this.onClick.bind(this))},onClick:function(f){var d=daum.Event.getElement(f);if(d.tagName.toLowerCase()!="input"){return}var b=T.admin.Editor.Util;var c=this.elements;var a=c.panel;if(d===c.checkCCL){if(c.checkCCL.checked){daum.Element.addClassName(a,"ccl_use");c.radioComUseY.checked=true;c.radioChgY.checked=true}else{daum.Element.removeClassName(a,"ccl_use");daum.Element.removeClassName(a,"ccl_noncommercial");daum.Element.removeClassName(a,"ccl_nonchange");daum.Element.removeClassName(a,"ccl_optchange");c.radioComUseY.checked=false;c.radioComUseN.checked=false;c.radioChgY.checked=false;c.radioChgN.checked=false;c.radioChgP.checked=false}}else{if(b.getSelectedRadioValue("cclCommercial")=="2"){daum.Element.addClassName(a,"ccl_noncommercial")}else{daum.Element.removeClassName(a,"ccl_noncommercial")}if(b.getSelectedRadioValue("cclDerive")=="2"){daum.Element.addClassName(a,"ccl_nonchange");daum.Element.removeClassName(a,"ccl_optchange")}else{if(b.getSelectedRadioValue("cclDerive")=="3"){daum.Element.removeClassName(a,"ccl_nonchange");daum.Element.addClassName(a,"ccl_optchange")}else{daum.Element.removeClassName(a,"ccl_nonchange");daum.Element.removeClassName(a,"ccl_optchange")}}}},getParam:function(){var b=T.admin.Editor.Util;var a={};var c=this.elements.checkCCL.checked;a.cclCommercial=c?b.getSelectedRadioValue("cclCommercial"):0;a.cclDerive=c?b.getSelectedRadioValue("cclDerive"):0;return a}};T.admin.Editor.PanelPlugin={elements:{panel:daum.$("panelPlugin")},init:function(){daum.Event.addEvent(this.elements.panel,"click",function(c){var b=daum.Event.getElement(c);if(b.tagName.toLowerCase()=="span"&&daum.Element.getParent(b).tagName.toLowerCase()=="a"){daum.Event.preventDefault(c);b=daum.Element.getParent(b);var a=daum.String.toInt(b.getAttribute("data-width"));var d=daum.String.toInt(b.getAttribute("data-height"));daum.Browser.popup(b.href,a,d,{scroll:"yes",resize:"yes"})}})}};T.admin.Editor.PanelGift={elements:{panel:daum.$("panelGift")},init:function(){if(this.elements.panel){daum.Event.addEvent(this.elements.panel,"click",function(c){var b=daum.Event.getElement(c);if(b.tagName.toLowerCase()=="span"&&daum.Element.getParent(b).tagName.toLowerCase()=="a"){daum.Event.preventDefault(c);b=daum.Element.getParent(b);var a=daum.String.toInt(b.getAttribute("data-width"));var d=daum.String.toInt(b.getAttribute("data-height"));daum.Browser.popup(b.href,a,d,{scroll:"yes",resize:"yes"})}})}}};T.admin.Editor.PanelWriting={editor:null,elements:{panel:daum.$("panelWritingAndForm"),boxWriting:daum.$$("#panelWritingAndForm div.box_listwriting")[0],btnDaumLike:daum.$("btnDaumLike"),btnQuestion:daum.$("btnWritingInfo"),boxBalloon:daum.$("boxWritingInfo")},templates:{titleWriting:'<h4 class="screen_out">비공개 글</h4>',emptyWriting:"<p>비공개 글이 없습니다.</p>",listWriting:'<ul class="list_writion list_dayadd">{for item in items}<li><a href="${item.url}"><span class="txt">${item.title}</span><span class="day">${item.date}</span></a></li>{/for}</ul>',button:'<div class="line"></div><div class="box_btn"><ul class="list_pagemove"><li><{if isPrevActive}a href="javascript:;"{else}span{/if} class="btn_comm btn_prev">이전 페이지로</{if isPrevActive}a{else}span{/if}></li><li><{if isNextActive}a href="javascript:;"{else}span{/if} class="btn_comm btn_next">다음 페이지로</{if isPrevActive}a{else}span{/if}></li></ul></div>'},attributes:{pagingSize:5,totalCnt:0,currentIdx:0},init:function(a){this.editor=a;var b=this.elements;document.body.appendChild(b.boxBalloon);if(b.btnDaumLike){daum.Event.addEvent(b.btnDaumLike,"click",function(c){daum.Event.preventDefault(c);window.open("http://notice.tistory.com/2169")})}daum.Event.addEvent(b.btnQuestion,"mouseover",this.showLayer.bind(this));daum.Event.addEvent(b.btnQuestion,"mouseout",this.hideLayer.bind(this));daum.Event.addEvent(b.btnQuestion,"click",function(c){daum.Event.preventDefault(c)});daum.Event.addEvent(b.panel,"click",this.onClick.bind(this));this.loadWritingList(0)},showLayer:function(d){var c=this.elements.boxBalloon;var f=daum.Element.getCoords(this.elements.btnQuestion);var b=0;var a=daum.Element.getParent(this.elements.btnQuestion);while(a!==document.body){b+=a.scrollTop;a=daum.Element.getParent(a)}daum.Element.setPosition(c,f.left-99,f.top+20-b);daum.Element.show(c)},hideLayer:function(a){daum.Element.hide(this.elements.boxBalloon)},onClick:function(f){var d=daum.Event.getElement(f);var a=this.elements.panel;var b=daum.$$("div.box_listwriting a.btn_prev",a)[0];var c=daum.$$("div.box_listwriting a.btn_next",a)[0];if(d==b){daum.Event.preventDefault(f);this.loadWritingList(this.attributes.currentIdx-this.attributes.pagingSize)}else{if(d==c){daum.Event.preventDefault(f);this.loadWritingList(this.attributes.currentIdx+this.attributes.pagingSize)}}},loadWritingList:function(b){var a=T.admin.Editor.Util;var c=this;a.sendRequest({url:"/admin/entry/post/loadPrivateEntryList.php",method:"POST",paramString:"start="+b+"&limit="+this.attributes.pagingSize,onsuccess:function(e){var d=daum.jsonToObject(e.responseText);c.attributes.currentIdx=b;c.renderWritingList(d)}})},renderWritingList:function(d){var a=this.attributes;var c=this.getHtml("titleWriting");if(!d.error&&!!d.data.privateEntryList&&d.data.privateEntryList.results.length>0){a.totalCnt=parseInt(d.data.privateEntryList.totalCount);var b=d.data.privateEntryList.results;c+=this.getHtml("listWriting",{items:b});if(a.totalCnt>a.pagingSize){c+=this.getHtml("button",{isPrevActive:(a.currentIdx!=0),isNextActive:(a.currentIdx+a.pagingSize<a.totalCnt)})}}else{c+=this.getHtml("emptyWriting")}this.elements.boxWriting.innerHTML=c},getHtml:function(a,c){var b=this.templates;if(!b.hasOwnProperty(a)){return null}if(daum.Object.isString(b[a])){b[a]=TrimPath.parseTemplate(b[a])}return b[a].process(c)}};T.admin.Editor.PanelForm={editor:null,elements:{panel:daum.$("panelWritingAndForm"),boxForm:daum.$$("#panelWritingAndForm div.box_form")[0],btnQuestion:daum.$("btnFormInfo"),boxBalloon:daum.$("boxFormInfo")},templates:{titleForm:'<h4 class="screen_out">서식</h4>',emptyForm:"<p>사용 가능한 서식이 없습니다.</p>",listForm:'<ul class="list_writion">{for item in items}<li><a href="#templateId-${item.id}"><span class="txt">${item.title}</span></a></li>{/for}</ul>',button:'<div class="line"></div><div class="box_btn"><ul class="list_pagemove"><li><{if isPrevActive}a href="javascript:;"{else}span{/if} class="btn_comm btn_prev">이전 페이지로</{if isPrevActive}a{else}span{/if}></li><li><{if isNextActive}a href="javascript:;"{else}span{/if} class="btn_comm btn_next">다음 페이지로</{if isPrevActive}a{else}span{/if}></li></ul></div>'},attributes:{pagingSize:5,totalCnt:0,currentIdx:0},init:function(a){this.editor=a;var b=this.elements;document.body.appendChild(b.boxBalloon);daum.Event.addEvent(b.btnQuestion,"mouseover",this.showLayer.bind(this));daum.Event.addEvent(b.btnQuestion,"mouseout",this.hideLayer.bind(this));daum.Event.addEvent(b.btnQuestion,"click",function(c){daum.Event.preventDefault(c)});daum.Event.addEvent(b.panel,"click",this.onClick.bind(this));this.loadFormList(0)},showLayer:function(d){var c=this.elements.boxBalloon;var f=daum.Element.getCoords(this.elements.btnQuestion);var b=0;var a=daum.Element.getParent(this.elements.btnQuestion);while(a!==document.body){b+=a.scrollTop;a=daum.Element.getParent(a)}daum.Element.setPosition(c,f.left-99,f.top+20-b);daum.Element.show(c)},hideLayer:function(a){daum.Element.hide(this.elements.boxBalloon)},onClick:function(f){var d=daum.Event.getElement(f);var a=this.elements.panel;var c=daum.$$("div.box_form a.btn_prev",a)[0];var b=daum.$$("div.box_form a.btn_next",a)[0];if(d==c){daum.Event.preventDefault(f);this.loadFormList(this.attributes.currentIdx-this.attributes.pagingSize)}else{if(d==b){daum.Event.preventDefault(f);this.loadFormList(this.attributes.currentIdx+this.attributes.pagingSize)}else{if(d.tagName.toLowerCase()=="span"&&daum.Element.getParent(d).tagName.toLowerCase()=="a"&&daum.Element.getParent(d).href.indexOf("#templateId-")>-1){daum.Event.preventDefault(f);this.loadForm(daum.Element.getParent(d).href.split("#templateId-")[1])}}}},loadFormList:function(b){var a=T.admin.Editor.Util;var c=this;a.sendRequest({url:"/admin/entry/post/loadTemplatesList.php",method:"POST",paramString:"start="+b+"&limit="+this.attributes.pagingSize,onsuccess:function(e){var d=daum.jsonToObject(e.responseText);c.attributes.currentIdx=b;c.renderFormList(d)}})},renderFormList:function(d){var a=this.attributes;var c=this.getHtml("titleForm");if(!d.error&&!!d.data.templateList&&d.data.templateList.results.length>0){a.totalCnt=d.data.templateList.totalCount;var b=d.data.templateList.results;c+=this.getHtml("listForm",{items:b});if(a.totalCnt>a.pagingSize){c+=this.getHtml("button",{isPrevActive:(a.currentIdx!=0),isNextActive:(a.currentIdx+a.pagingSize<a.totalCnt)})}}else{c+=this.getHtml("emptyForm")}this.elements.boxForm.innerHTML=c},loadForm:function(b){var a=T.admin.Editor.Util;if(!Editor.getCanvas().canHTML()){alert("에디터 상태에서만 삽입할 수 있습니다.");return}a.sendRequest({url:"/admin/entry/post/loadTemplate.php",method:"POST",paramString:"templateId="+b,onsuccess:function(d){var c=daum.jsonToObject(d.responseText);Editor.pasteTtml("<div>"+c.data.template+"</div>",true)}})},getHtml:function(a,c){var b=this.templates;if(!b.hasOwnProperty(a)){return null}if(daum.Object.isString(b[a])){b[a]=TrimPath.parseTemplate(b[a])}return b[a].process(c)}};
(function(){var b=["modify","getSidebar","getAttachBox","getContent","getCanvas","permitUnload"];var a=function(){var f=true;if(!!window.Editor){daum.Array.each(b,function(g){if(!window.Editor[g]){f=false}})}else{f=false}return f};var d=daum.$("tistoryGnb");var c=function(){daum.Element.setLeft(daum.$$("ul",d)[0],(daum.Element.getCoordsTarget(daum.$$(".link_btn",d)[0],d)["right"]-100));T.admin.Editor.init()};if(a()){c()}else{var e=daum.Function.interval(function(){if(a()){clearInterval(e);c()}},10)}})();
function TransCoordinator(){this.COORD_TM=1;this.COORD_KTM=2;this.COORD_UTM=3;this.COORD_CONGNAMUL=4;this.COORD_WGS84=5;this.COORD_BESSEL=6;this.COORD_WTM=7;this.COORD_WKTM=8;this.COORD_BUTM=9;this.COORD_WCONGNAMUL=10;this.COORD_UTMK=11;this.COORD_BUTMK=12;this.BASE_TM_LON=127;this.BASE_TM_LAT=38;this.BASE_KTM_LON=128;this.BASE_KTM_LAT=38;this.BASE_UTM_LON=129;this.BASE_UTM_LAT=0;this.BASE_UTMK_LON=127.5;this.BASE_UTMK_LAT=38;this.m_AW=6378137;this.m_FW=1/298.257223563;this.m_AB=6377397.155;this.m_FB=1/299.152813;this.m_OKKTM=1;this.m_OKUTM=0.9996;this.m_OKGTM=0.9999;this.m_TX=115.8;this.m_TY=-474.99;this.m_TZ=-674.11;this.m_TOMEGA=1.16;this.m_TPHI=-2.31;this.m_TKAPPA=-1.63;this.m_TS=-6.43;this.m_TMODE=1;this.m_ux0=0;this.m_uy0=500000;this.m_ukx0=2000000;this.m_uky0=1000000;this.m_x0=500000;this.m_y0=200000;this.m_x1=600000;this.m_y1=400000;this.m_dx=0;this.m_dy=0;this.m_dz=0;this.m_omega=0;this.m_phi=0;this.m_kappa=0;this.m_ds=0;this.m_imode=0;this.rectArray1=new Array(new Object(),new Object(),new Object(),new Object(),new Object(),new Object(),new Object(),new Object());this.rectArray2=new Array(new Object(),new Object(),new Object(),new Object(),new Object(),new Object(),new Object(),new Object());this.x=0;this.y=0;this.w=0;this.h=0;this.deltaValue1=new Array(new Array(0,50000),new Array(0,50000),new Array(0,10000),new Array(-70378,-136),new Array(-144738,-2161),new Array(23510,-111),new Array(0,50000),new Array(0,50000));this.deltaValue2=new Array(new Array(0,-50000),new Array(0,-50000),new Array(0,-10000),new Array(70378,136),new Array(144738,2161),new Array(-23510,111),new Array(0,-50000),new Array(0,-50000));this.rectArray1[0].x=112500;this.rectArray1[0].y=-50000;this.rectArray1[0].w=146000-112500;this.rectArray1[0].h=3000+50000;this.rectArray1[1].x=146000;this.rectArray1[1].y=-50000;this.rectArray1[1].w=191600-146000;this.rectArray1[1].h=8600+50000;this.rectArray1[2].x=130000;this.rectArray1[2].y=44000;this.rectArray1[2].w=145000-130000;this.rectArray1[2].h=58000-44000;this.rectArray1[3].x=532500;this.rectArray1[3].y=437500;this.rectArray1[3].w=557500-532500;this.rectArray1[3].h=462500-437500;this.rectArray1[4].x=625000;this.rectArray1[4].y=412500;this.rectArray1[4].w=650000-625000;this.rectArray1[4].h=437500-412500;this.rectArray1[5].x=-12500;this.rectArray1[5].y=462500;this.rectArray1[5].w=5000+12500;this.rectArray1[5].h=512500-462500;this.rectArray1[6].x=191600;this.rectArray1[6].y=-50000;this.rectArray1[6].w=194200-191600;this.rectArray1[6].h=2700+50000;this.rectArray1[7].x=194200;this.rectArray1[7].y=-50000;this.rectArray1[7].w=200000-194200;this.rectArray1[7].h=8600+50000;this.rectArray2[0].x=112500;this.rectArray2[0].y=-50000;this.rectArray2[0].w=146000-112500;this.rectArray2[0].h=3000+50000;this.rectArray2[1].x=146000;this.rectArray2[1].y=-50000;this.rectArray2[1].w=191600-146000;this.rectArray2[1].h=8600+50000;this.rectArray2[2].x=130000;this.rectArray2[2].y=44000;this.rectArray2[2].w=145000-130000;this.rectArray2[2].h=58000-44000;this.rectArray2[3].x=532500;this.rectArray2[3].y=437500;this.rectArray2[3].w=557500-532500;this.rectArray2[3].h=462500-437500;this.rectArray2[4].x=625000;this.rectArray2[4].y=412500;this.rectArray2[4].w=650000-625000;this.rectArray2[4].h=437500-412500;this.rectArray2[5].x=-12500;this.rectArray2[5].y=462500;this.rectArray2[5].w=5000+12500;this.rectArray2[5].h=512500-462500;this.rectArray2[6].x=191600;this.rectArray2[6].y=-50000;this.rectArray2[6].w=194200-191600;this.rectArray2[6].h=2700+50000;this.rectArray2[7].x=194200;this.rectArray2[7].y=-50000;this.rectArray2[7].w=200000-194200;this.rectArray2[7].h=8600+50000;for(var a=0;a<this.rectArray1.length;a++){this.rectArray2[a].x+=this.deltaValue1[a][0];this.rectArray2[a].y+=this.deltaValue1[a][1]}}TransCoordinator.prototype={convertCoord:function(h,g,i,c,f,d,k,j){var e=new Array(h,g);var b=f,a=d;switch(i){case this.COORD_TM:if(f<=0){b=this.BASE_TM_LON;a=this.BASE_TM_LAT}e=this.convertTM2(h,g,c,b,a,k,j);break;case this.COORD_KTM:if(f<=0){b=this.BASE_KTM_LON;a=this.BASE_KTM_LAT}e=this.convertKTM2(h,g,c,b,a,k,j);break;case this.COORD_UTM:if(f<=0){b=this.BASE_UTM_LON;a=this.BASE_UTM_LAT}e=this.convertUTM2(h,g,c,b,a,k,j);break;case this.COORD_CONGNAMUL:if(f<=0){b=this.BASE_TM_LON;a=this.BASE_TM_LAT}e=this.convertCONGNAMUL2(h,g,c,b,a,k,j);break;case this.COORD_WGS84:e=this.convertWGS2(h,g,c,b,a,k,j);break;case this.COORD_BESSEL:e=this.convertBESSEL2(h,g,c,b,a,k,j);break;case this.COORD_WTM:if(f<=0){b=this.BASE_TM_LON;a=this.BASE_TM_LAT}e=this.convertWTM2(h,g,c,b,a,k,j);break;case this.COORD_WKTM:if(f<=0){b=this.BASE_KTM_LON;a=this.BASE_KTM_LAT}e=this.convertWKTM2(h,g,c,b,a,k,j);break;case this.COORD_BUTM:if(f<=0){b=this.BASE_UTM_LON;a=this.BASE_UTM_LAT}e=this.convertBUTM2(h,g,c,b,a,k,j);break;case this.COORD_WCONGNAMUL:if(f<=0){b=this.BASE_TM_LON;a=this.BASE_TM_LAT}e=this.convertWCONGNAMUL2(h,g,c,b,a,k,j);break;case this.COORD_UTMK:if(f<=0){b=this.BASE_UTMK_LON;a=this.BASE_UTMK_LAT}e=this.convertUTMK2(h,g,c,b,a,k,j);break;case this.COORD_BUTMK:if(f<=0){b=this.BASE_UTMK_LON;a=this.BASE_UTMK_LAT}e=this.convertBUTMK2(h,g,c,b,a,k,j);break}return e},convertTM2:function(h,g,c,f,d,j,i){var e=new Array(h,g);var b=j,a=i;switch(c){case this.COORD_TM:if(b<=0){b=this.BASE_TM_LON;a=this.BASE_TM_LAT}e=this.convertTM2BESSEL(h,g,f,d);e=this.convertBESSEL2TM(e[0],e[1],b,a);break;case this.COORD_KTM:e=this.convertTM2BESSEL(h,g,f,d);e=this.convertBESSEL2KTM(e[0],e[1]);break;case this.COORD_UTM:if(b<=0){b=this.BASE_UTM_LON;a=this.BASE_UTM_LAT}e=this.convertTM2BESSEL(h,g,f,d);e=this.convertBESSEL2WGS(e[0],e[1]);e=this.convertWGS2UTM(e[0],e[1],b,a);break;case this.COORD_CONGNAMUL:e=this.convertTM2BESSEL(h,g,f,d);e=this.convertBESSEL2CONG(e[0],e[1]);break;case this.COORD_WGS84:e=this.convertTM2BESSEL(h,g,f,d);e=this.convertBESSEL2WGS(e[0],e[1]);break;case this.COORD_BESSEL:e=this.convertTM2BESSEL(h,g,f,d);break;case this.COORD_WTM:if(b<=0){b=this.BASE_TM_LON;a=this.BASE_TM_LAT}e=this.convertTM2BESSEL(h,g,f,d);e=this.convertBESSEL2WGS(e[0],e[1]);e=this.convertWGS2WTM(e[0],e[1],b,a);break;case this.COORD_WKTM:e=this.convertTM2BESSEL(h,g,f,d);e=this.convertBESSEL2WGS(e[0],e[1]);e=this.convertWGS2WKTM(e[0],e[1]);break;case this.COORD_BUTM:if(b<=0){b=this.BASE_UTM_LON;a=this.BASE_UTM_LAT}e=this.convertTM2BESSEL(h,g,f,d);e=this.convertBESSEL2BUTM(e[0],e[1],b,a);break;case this.COORD_WCONGNAMUL:e=this.convertTM2BESSEL(h,g,f,d);e=this.convertBESSEL2WGS(e[0],e[1]);e=this.convertWGS2WCONG(e[0],e[1]);break;case this.COORD_UTMK:e=this.convertTM2BESSEL(h,g,f,d);e=this.convertBESSEL2WGS(e[0],e[1]);e=this.convertWGS2UTMK(e[0],e[1]);break;case this.COORD_BUTMK:e=this.convertTM2BESSEL(h,g,f,d);e=this.convertBESSEL2BUTMK(e[0],e[1]);break}return e},convertKTM2:function(h,g,c,f,d,j,i){var e=new Array(h,g);var b=j,a=i;switch(c){case this.COORD_TM:if(b<=0){b=this.BASE_TM_LON;a=this.BASE_TM_LAT}e=this.convertKTM2BESSEL(h,g);e=this.convertBESSEL2TM(e[0],e[1],b,a);break;case this.COORD_KTM:break;case this.COORD_UTM:if(b<=0){b=this.BASE_UTM_LON;a=this.BASE_UTM_LAT}e=this.convertKTM2BESSEL(h,g);e=this.convertBESSEL2WGS(e[0],e[1]);e=this.convertWGS2UTM(e[0],e[1],b,a);break;case this.COORD_CONGNAMUL:e=this.convertKTM2BESSEL(h,g);e=this.convertBESSEL2CONG(e[0],e[1]);break;case this.COORD_WGS84:e=this.convertKTM2BESSEL(h,g);e=this.convertBESSEL2WGS(e[0],e[1]);break;case this.COORD_BESSEL:e=this.convertKTM2BESSEL(h,g);break;case this.COORD_WTM:if(b<=0){b=this.BASE_TM_LON;a=this.BASE_TM_LAT}e=this.convertKTM2BESSEL(h,g);e=this.convertBESSEL2WGS(e[0],e[1]);e=this.convertWGS2WTM(e[0],e[1],b,a);break;case this.COORD_WKTM:e=this.convertKTM2BESSEL(h,g);e=this.convertBESSEL2WGS(e[0],e[1]);e=this.convertWGS2WKTM(e[0],e[1]);break;case this.COORD_BUTM:if(b<=0){b=this.BASE_UTM_LON;a=this.BASE_UTM_LAT}e=this.convertKTM2BESSEL(h,g);e=this.convertBESSEL2BUTM(e[0],e[1],b,a);break;case this.COORD_WCONGNAMUL:e=this.convertKTM2BESSEL(h,g);e=this.convertBESSEL2WGS(e[0],e[1]);e=this.convertWGS2WCONG(e[0],e[1]);break;case this.COORD_UTMK:e=this.convertKTM2BESSEL(h,g);e=this.convertBESSEL2WGS(e[0],e[1]);e=this.convertWGS2UTMK(e[0],e[1]);break;case this.COORD_BUTMK:e=this.convertKTM2BESSEL(h,g);e=this.convertBESSEL2BUTMK(e[0],e[1]);break}return e},convertUTM2:function(h,g,c,f,d,j,i){var e=new Array(h,g);var b=j,a=i;switch(c){case this.COORD_TM:if(b<=0){b=this.BASE_TM_LON;a=this.BASE_TM_LAT}e=this.convertUTM2WGS(h,g,f,d);e=this.convertWGS2BESSEL(e[0],e[1]);e=this.convertBESSEL2TM(e[0],e[1],b,a);break;case this.COORD_KTM:e=this.convertUTM2WGS(h,g,f,d);e=this.convertWGS2BESSEL(e[0],e[1]);e=this.convertBESSEL2KTM(e[0],e[1]);break;case this.COORD_UTM:if(b<=0){b=this.BASE_UTM_LON;a=this.BASE_UTM_LAT}e=this.convertUTM2WGS(h,g,f,d);e=this.convertWGS2UTM(e[0],e[1],b,a);break;case this.COORD_CONGNAMUL:e=this.convertUTM2WGS(h,g,f,d);e=this.convertWGS2BESSEL(e[0],e[1]);e=this.convertBESSEL2CONG(e[0],e[1]);break;case this.COORD_WGS84:e=this.convertUTM2WGS(h,g,f,d);break;case this.COORD_BESSEL:e=this.convertUTM2WGS(h,g,f,d);e=this.convertWGS2BESSEL(e[0],e[1]);break;case this.COORD_WTM:if(b<=0){b=this.BASE_TM_LON;a=this.BASE_TM_LAT}e=this.convertUTM2WGS(h,g,f,d);e=this.convertWGS2WTM(e[0],e[1],b,a);break;case this.COORD_WKTM:e=this.convertUTM2WGS(h,g,f,d);e=this.convertWGS2WKTM(e[0],e[1]);break;case this.COORD_BUTM:if(b<=0){b=this.BASE_UTM_LON;a=this.BASE_UTM_LAT}e=this.convertUTM2WGS(h,g,f,d);e=this.convertWGS2BESSEL(e[0],e[1]);e=this.convertBESSEL2BUTM(e[0],e[1],b,a);break;case this.COORD_WCONGNAMUL:e=this.convertUTM2WGS(h,g,f,d);e=this.convertWGS2WCONG(e[0],e[1]);break;case this.COORD_UTMK:e=this.convertUTM2WGS(h,g,f,d);e=this.convertWGS2UTMK(e[0],e[1]);break;case this.COORD_BUTMK:e=this.convertUTM2WGS(h,g,f,d);e=this.convertWGS2BESSEL(e[0],e[1]);e=this.convertBESSEL2BUTMK(e[0],e[1]);break}return e},convertCONGNAMUL2:function(h,g,c,f,d,j,i){var e=new Array(h,g);var b=j,a=i;switch(c){case this.COORD_TM:if(b<=0){b=this.BASE_TM_LON;a=this.BASE_TM_LAT}e=this.convertCONG2BESSEL(h,g);e=this.convertBESSEL2TM(e[0],e[1],b,a);break;case this.COORD_KTM:e=this.convertCONG2BESSEL(h,g);e=this.convertBESSEL2KTM(e[0],e[1]);break;case this.COORD_UTM:if(b<=0){b=this.BASE_UTM_LON;a=this.BASE_UTM_LAT}e=this.convertCONG2BESSEL(h,g);e=this.convertBESSEL2WGS(e[0],e[1]);e=this.convertWGS2UTM(e[0],e[1],b,a);break;case this.COORD_CONGNAMUL:break;case this.COORD_WGS84:e=this.convertCONG2BESSEL(h,g);e=this.convertBESSEL2WGS(e[0],e[1]);break;case this.COORD_BESSEL:e=this.convertCONG2BESSEL(h,g);break;case this.COORD_WTM:if(b<=0){b=this.BASE_TM_LON;a=this.BASE_TM_LAT}e=this.convertCONG2BESSEL(h,g);e=this.convertBESSEL2WGS(e[0],e[1]);e=this.convertWGS2WTM(e[0],e[1],b,a);break;case this.COORD_WKTM:e=this.convertCONG2BESSEL(h,g);e=this.convertBESSEL2WGS(e[0],e[1]);e=this.convertWGS2WKTM(e[0],e[1]);break;case this.COORD_BUTM:if(b<=0){b=this.BASE_UTM_LON;a=this.BASE_UTM_LAT}e=this.convertCONG2BESSEL(h,g);e=this.convertBESSEL2BUTM(e[0],e[1],b,a);break;case this.COORD_WCONGNAMUL:e=this.convertCONG2BESSEL(h,g);e=this.convertBESSEL2WGS(e[0],e[1]);e=this.convertWGS2WCONG(e[0],e[1]);break;case this.COORD_UTMK:e=this.convertCONG2BESSEL(h,g);e=this.convertBESSEL2WGS(e[0],e[1]);e=this.convertWGS2UTMK(e[0],e[1]);break;case this.COORD_BUTMK:e=this.convertCONG2BESSEL(h,g);e=this.convertBESSEL2BUTMK(e[0],e[1]);break}return e},convertWGS2:function(h,g,c,f,d,j,i){var e=new Array(h,g);var b=j,a=i;switch(c){case this.COORD_TM:if(b<=0){b=this.BASE_TM_LON;a=this.BASE_TM_LAT}e=this.convertWGS2BESSEL(h,g);e=this.convertBESSEL2TM(e[0],e[1],b,a);break;case this.COORD_KTM:e=this.convertWGS2BESSEL(h,g);e=this.convertBESSEL2KTM(e[0],e[1]);break;case this.COORD_UTM:if(b<=0){b=this.BASE_UTM_LON;a=this.BASE_UTM_LAT}e=this.convertWGS2UTM(h,g,b,a);break;case this.COORD_CONGNAMUL:e=this.convertWGS2BESSEL(h,g);e=this.convertBESSEL2CONG(e[0],e[1]);break;case this.COORD_WGS84:break;case this.COORD_BESSEL:e=this.convertWGS2BESSEL(h,g);break;case this.COORD_WTM:if(b<=0){b=this.BASE_TM_LON;a=this.BASE_TM_LAT}e=this.convertWGS2WTM(h,g,b,a);break;case this.COORD_WKTM:e=this.convertWGS2WKTM(h,g);break;case this.COORD_BUTM:if(b<=0){b=this.BASE_UTM_LON;a=this.BASE_UTM_LAT}e=this.convertWGS2BESSEL(h,g);e=this.convertBESSEL2BUTM(e[0],e[1],b,a);break;case this.COORD_WCONGNAMUL:e=this.convertWGS2WCONG(h,g);break;case this.COORD_UTMK:e=this.convertWGS2UTMK(e[0],e[1]);break;case this.COORD_BUTMK:e=this.convertWGS2BESSEL(h,g);e=this.convertBESSEL2BUTMK(e[0],e[1]);break}return e},convertBESSEL2:function(h,g,c,f,d,j,i){var e=new Array(h,g);var b=j,a=i;switch(c){case this.COORD_TM:if(b<=0){b=this.BASE_TM_LON;a=this.BASE_TM_LAT}e=this.convertBESSEL2TM(h,g,b,a);break;case this.COORD_KTM:e=this.convertBESSEL2KTM(h,g);break;case this.COORD_UTM:if(b<=0){b=this.BASE_UTM_LON;a=this.BASE_UTM_LAT}e=this.convertBESSEL2WGS(h,g);e=this.convertWGS2UTM(e[0],e[1],b,a);break;case this.COORD_CONGNAMUL:e=this.convertBESSEL2CONG(h,g);break;case this.COORD_WGS84:e=this.convertBESSEL2WGS(h,g);break;case this.COORD_BESSEL:break;case this.COORD_WTM:if(b<=0){b=this.BASE_TM_LON;a=this.BASE_TM_LAT}e=this.convertBESSEL2WGS(h,g);e=this.convertWGS2WTM(e[0],e[1],b,a);break;case this.COORD_WKTM:e=this.convertBESSEL2WGS(h,g);e=this.convertWGS2WKTM(e[0],e[1]);break;case this.COORD_BUTM:if(b<=0){b=this.BASE_UTM_LON;a=this.BASE_UTM_LAT}e=this.convertBESSEL2BUTM(h,g,b,a);break;case this.COORD_WCONGNAMUL:e=this.convertBESSEL2WGS(h,g);e=this.convertWGS2WCONG(e[0],e[1]);break;case this.COORD_UTMK:e=this.convertBESSEL2WGS(h,g);e=this.convertWGS2UTMK(e[0],e[1]);break;case this.COORD_BUTMK:e=this.convertBESSEL2BUTMK(h,g);break}return e},convertWTM2:function(h,g,c,f,d,j,i){var e=new Array(h,g);var b=j,a=i;switch(c){case this.COORD_TM:if(b<=0){b=this.BASE_TM_LON;a=this.BASE_TM_LAT}e=this.convertWTM2WGS(h,g,f,d);e=this.convertWGS2BESSEL(e[0],e[1]);e=this.convertBESSEL2TM(e[0],e[1],b,a);break;case this.COORD_KTM:e=this.convertWTM2WGS(h,g,f,d);e=this.convertWGS2BESSEL(e[0],e[1]);e=this.convertBESSEL2KTM(e[0],e[1]);break;case this.COORD_UTM:if(b<=0){b=this.BASE_UTM_LON;a=this.BASE_UTM_LAT}e=this.convertWTM2WGS(h,g,f,d);e=this.convertWGS2UTM(e[0],e[1],b,a);break;case this.COORD_CONGNAMUL:e=this.convertWTM2WGS(h,g,f,d);e=this.convertWGS2BESSEL(e[0],e[1]);e=this.convertBESSEL2CONG(e[0],e[1]);break;case this.COORD_WGS84:e=this.convertWTM2WGS(h,g,f,d);e=this.convertWGS2BESSEL(e[0],e[1]);e=this.convertBESSEL2WGS(e[0],e[1]);break;case this.COORD_BESSEL:e=this.convertWTM2WGS(h,g,f,d);e=this.convertWGS2BESSEL(e[0],e[1]);break;case this.COORD_WTM:if(b<=0){b=this.BASE_TM_LON;a=this.BASE_TM_LAT}e=this.convertWTM2WGS(h,g,f,d);e=this.convertWGS2WTM(e[0],e[1],b,a);break;case this.COORD_WKTM:e=this.convertWTM2WGS(h,g,f,d);e=this.convertWGS2WKTM(e[0],e[1]);break;case this.COORD_BUTM:if(b<=0){b=this.BASE_UTM_LON;a=this.BASE_UTM_LAT}e=this.convertWTM2WGS(h,g,f,d);e=this.convertWGS2BESSEL(e[0],e[1]);e=this.convertBESSEL2BUTM(e[0],e[1],b,a);break;case this.COORD_WCONGNAMUL:e=this.convertWTM2WGS(h,g,f,d);e=this.convertWGS2WCONG(e[0],e[1]);break;case this.COORD_UTMK:e=this.convertWTM2WGS(h,g,f,d);e=this.convertWGS2UTMK(e[0],e[1]);break;case this.COORD_BUTMK:e=this.convertWTM2WGS(h,g,f,d);e=this.convertWGS2BESSEL(e[0],e[1]);e=this.convertBESSEL2BUTMK(e[0],e[1]);break}return e},convertWKTM2:function(h,g,c,f,d,j,i){var e=new Array(h,g);var b=j,a=i;switch(c){case this.COORD_TM:if(b<=0){b=this.BASE_TM_LON;a=this.BASE_TM_LAT}e=this.convertWKTM2WGS(h,g);e=this.convertWGS2BESSEL(e[0],e[1]);e=this.convertBESSEL2TM(e[0],e[1],b,a);break;case this.COORD_KTM:break;case this.COORD_UTM:if(b<=0){b=this.BASE_UTM_LON;a=this.BASE_UTM_LAT}e=this.convertWKTM2WGS(h,g);e=this.convertWGS2UTM(e[0],e[1],b,a);break;case this.COORD_CONGNAMUL:e=this.convertWKTM2WGS(h,g);e=this.convertWGS2BESSEL(e[0],e[1]);e=this.convertBESSEL2CONG(e[0],e[1]);break;case this.COORD_WGS84:e=this.convertWKTM2WGS(h,g);e=this.convertWGS2BESSEL(e[0],e[1]);e=this.convertBESSEL2WGS(e[0],e[1]);break;case this.COORD_BESSEL:e=this.convertWKTM2WGS(h,g);e=this.convertWGS2BESSEL(e[0],e[1]);break;case this.COORD_WTM:if(b<=0){b=this.BASE_TM_LON;a=this.BASE_TM_LAT}e=this.convertWKTM2WGS(h,g);e=this.convertWGS2WTM(e[0],e[1],b,a);break;case this.COORD_WKTM:break;case this.COORD_BUTM:if(b<=0){b=this.BASE_UTM_LON;a=this.BASE_UTM_LAT}e=this.convertWKTM2WGS(h,g);e=this.convertWGS2BESSEL(e[0],e[1]);e=this.convertBESSEL2BUTM(e[0],e[1],b,a);break;case this.COORD_WCONGNAMUL:e=this.convertWKTM2WGS(h,g);e=this.convertWGS2WCONG(e[0],e[1]);break;case this.COORD_UTMK:e=this.convertWKTM2WGS(h,g);e=this.convertWGS2UTMK(e[0],e[1]);break;case this.COORD_BUTMK:e=this.convertWKTM2WGS(h,g);e=this.convertWGS2BESSEL(e[0],e[1]);e=this.convertBESSEL2BUTMK(e[0],e[1]);break}return e},convertBUTM2:function(h,g,c,f,d,j,i){var e=new Array(h,g);var b=j,a=i;switch(c){case this.COORD_TM:if(b<=0){b=this.BASE_TM_LON;a=this.BASE_TM_LAT}e=this.convertBUTM2BESSEL(h,g,f,d);e=this.convertBESSEL2TM(e[0],e[1],b,a);break;case this.COORD_KTM:e=this.convertBUTM2BESSEL(h,g,f,d);e=this.convertBESSEL2KTM(e[0],e[1]);break;case this.COORD_UTM:if(b<=0){b=this.BASE_UTM_LON;a=this.BASE_UTM_LAT}e=this.convertBUTM2BESSEL(h,g,f,d);e=this.convertBESSEL2WGS(e[0],e[1]);e=this.convertWGS2UTM(e[0],e[1],b,a);break;case this.COORD_CONGNAMUL:e=this.convertBUTM2BESSEL(h,g,f,d);e=this.convertBESSEL2CONG(e[0],e[1]);break;case this.COORD_WGS84:e=this.convertBUTM2BESSEL(h,g,f,d);e=this.convertBESSEL2WGS(e[0],e[1]);break;case this.COORD_BESSEL:e=this.convertBUTM2BESSEL(h,g,f,d);break;case this.COORD_WTM:if(b<=0){b=this.BASE_TM_LON;a=this.BASE_TM_LAT}e=this.convertBUTM2BESSEL(h,g,f,d);e=this.convertBESSEL2WGS(e[0],e[1]);e=this.convertWGS2WTM(e[0],e[1],b,a);break;case this.COORD_WKTM:e=this.convertBUTM2BESSEL(h,g,f,d);e=this.convertBESSEL2WGS(e[0],e[1]);e=this.convertWGS2WKTM(e[0],e[1]);break;case this.COORD_BUTM:if(b<=0){b=this.BASE_UTM_LON;a=this.BASE_UTM_LAT}e=this.convertBUTM2BESSEL(h,g,f,d);e=this.convertBESSEL2BUTM(e[0],e[1],b,a);break;case this.COORD_WCONGNAMUL:e=this.convertBUTM2BESSEL(h,g,f,d);e=this.convertBESSEL2WGS(e[0],e[1]);e=this.convertWGS2WCONG(e[0],e[1]);break;case this.COORD_UTMK:e=this.convertBUTM2BESSEL(h,g,f,d);e=this.convertBESSEL2WGS(e[0],e[1]);e=this.convertWGS2UTMK(e[0],e[1]);break;case this.COORD_BUTMK:e=this.convertBUTM2BESSEL(h,g,f,d);e=this.convertBESSEL2BUTMK(e[0],e[1]);break}return e},convertWCONGNAMUL2:function(h,g,c,f,d,j,i){var e=new Array(h,g);var b=j,a=i;switch(c){case this.COORD_TM:if(b<=0){b=this.BASE_TM_LON;a=this.BASE_TM_LAT}e=this.convertWCONG2WGS(h,g);e=this.convertWGS2BESSEL(e[0],e[1]);e=this.convertBESSEL2TM(e[0],e[1],b,a);break;case this.COORD_KTM:e=this.convertWCONG2WGS(h,g);e=this.convertWGS2BESSEL(e[0],e[1]);e=this.convertBESSEL2KTM(e[0],e[1]);break;case this.COORD_UTM:if(b<=0){b=this.BASE_UTM_LON;a=this.BASE_UTM_LAT}e=this.convertWCONG2WGS(h,g);e=this.convertWGS2UTM(e[0],e[1],b,a);break;case this.COORD_CONGNAMUL:e=this.convertWCONG2WGS(h,g);e=this.convertWGS2BESSEL(e[0],e[1]);e=this.convertBESSEL2CONG(e[0],e[1]);break;case this.COORD_WGS84:e=this.convertWCONG2WGS(h,g);e=this.convertWGS2BESSEL(e[0],e[1]);e=this.convertBESSEL2WGS(e[0],e[1]);break;case this.COORD_BESSEL:e=this.convertWCONG2WGS(h,g);e=this.convertWGS2BESSEL(e[0],e[1]);break;case this.COORD_WTM:if(b<=0){b=this.BASE_TM_LON;a=this.BASE_TM_LAT}e=this.convertWCONG2WGS(h,g);e=this.convertWGS2WTM(e[0],e[1],b,a);break;case this.COORD_WKTM:e=this.convertWCONG2WGS(h,g);e=this.convertWGS2WKTM(e[0],e[1]);break;case this.COORD_BUTM:if(b<=0){b=this.BASE_UTM_LON;a=this.BASE_UTM_LAT}e=this.convertWCONG2WGS(h,g);e=this.convertWGS2BESSEL(e[0],e[1]);e=this.convertBESSEL2BUTM(e[0],e[1],b,a);break;case this.COORD_WCONGNAMUL:break;case this.COORD_UTMK:e=this.convertWCONG2WGS(h,g);e=this.convertWGS2UTMK(e[0],e[1]);break;case this.COORD_BUTMK:e=this.convertWCONG2WGS(h,g);e=this.convertWGS2BESSEL(e[0],e[1]);e=this.convertBESSEL2BUTMK(e[0],e[1]);break}return e},convertUTMK2:function(h,g,c,f,d,j,i){var e=new Array(h,g);var b=j,a=i;switch(c){case this.COORD_TM:if(b<=0){b=this.BASE_TM_LON;a=this.BASE_TM_LAT}e=this.convertUTMK2WGS(h,g);e=this.convertWGS2BESSEL(e[0],e[1]);e=this.convertBESSEL2TM(e[0],e[1],b,a);break;case this.COORD_KTM:e=this.convertUTMK2WGS(h,g);e=this.convertWGS2BESSEL(e[0],e[1]);e=this.convertBESSEL2KTM(e[0],e[1]);break;case this.COORD_UTM:if(b<=0){b=this.BASE_UTM_LON;a=this.BASE_UTM_LAT}e=this.convertUTMK2WGS(h,g);e=this.convertWGS2UTM(e[0],e[1],b,a);break;case this.COORD_CONGNAMUL:e=this.convertUTMK2WGS(h,g);e=this.convertWGS2BESSEL(e[0],e[1]);e=this.convertBESSEL2CONG(e[0],e[1]);break;case this.COORD_WGS84:e=this.convertUTMK2WGS(h,g);e=this.convertWGS2BESSEL(e[0],e[1]);e=this.convertBESSEL2WGS(e[0],e[1]);break;case this.COORD_BESSEL:e=this.convertUTMK2WGS(h,g);e=this.convertWGS2BESSEL(e[0],e[1]);break;case this.COORD_WTM:if(b<=0){b=this.BASE_TM_LON;a=this.BASE_TM_LAT}e=this.convertUTMK2WGS(h,g);e=this.convertWGS2WTM(e[0],e[1],b,a);break;case this.COORD_WKTM:e=this.convertUTMK2WGS(h,g);e=this.convertWGS2WKTM(e[0],e[1]);break;case this.COORD_BUTM:if(b<=0){b=this.BASE_UTM_LON;a=this.BASE_UTM_LAT}e=this.convertUTMK2WGS(h,g);e=this.convertWGS2BESSEL(e[0],e[1]);e=this.convertBESSEL2BUTM(e[0],e[1],b,a);break;case this.COORD_WCONGNAMUL:e=this.convertUTMK2WGS(h,g);e=this.convertWGS2WCONG(e[0],e[1]);break;case this.COORD_UTMK:break;case this.COORD_BUTMK:e=this.convertUTMK2WGS(h,g);e=this.convertWGS2BESSEL(e[0],e[1]);e=this.convertBESSEL2BUTMK(e[0],e[1]);break}return e},convertBUTMK2:function(h,g,c,f,d,j,i){var e=new Array(h,g);var b=j,a=i;switch(c){case this.COORD_TM:if(b<=0){b=this.BASE_TM_LON;a=this.BASE_TM_LAT}e=this.convertBUTMK2BESSEL(h,g);e=this.convertBESSEL2TM(e[0],e[1],b,a);break;case this.COORD_KTM:e=this.convertBUTMK2BESSEL(h,g);e=this.convertBESSEL2KTM(e[0],e[1]);break;case this.COORD_UTM:if(b<=0){b=this.BASE_UTM_LON;a=this.BASE_UTM_LAT}e=this.convertBUTMK2BESSEL(h,g);e=this.convertBESSEL2WGS(e[0],e[1]);e=this.convertWGS2UTM(e[0],e[1],b,a);break;case this.COORD_CONGNAMUL:e=this.convertBUTMK2BESSEL(h,g);e=this.convertBESSEL2CONG(e[0],e[1]);break;case this.COORD_WGS84:e=this.convertBUTMK2BESSEL(h,g);e=this.convertBESSEL2WGS(e[0],e[1]);break;case this.COORD_BESSEL:e=this.convertBUTMK2BESSEL(h,g);break;case this.COORD_WTM:if(b<=0){b=this.BASE_TM_LON;a=this.BASE_TM_LAT}e=this.convertBUTMK2BESSEL(h,g);e=this.convertBESSEL2WGS(e[0],e[1]);e=this.convertWGS2WTM(e[0],e[1],b,a);break;case this.COORD_WKTM:e=this.convertBUTMK2BESSEL(h,g);e=this.convertBESSEL2WGS(e[0],e[1]);e=this.convertWGS2WKTM(e[0],e[1]);break;case this.COORD_BUTM:if(b<=0){b=this.BASE_UTM_LON;a=this.BASE_UTM_LAT}e=this.convertBUTMK2BESSEL(h,g);e=this.convertBESSEL2BUTM(e[0],e[1],b,a);break;case this.COORD_WCONGNAMUL:e=this.convertBUTMK2BESSEL(h,g);e=this.convertBESSEL2WGS(e[0],e[1]);e=this.convertWGS2WCONG(e[0],e[1]);break;case this.COORD_UTMK:e=this.convertBUTMK2BESSEL(h,g);e=this.convertBESSEL2WGS(e[0],e[1]);e=this.convertWGS2UTMK(e[0],e[1]);break;case this.COORD_BUTMK:break}return e},convertBESSEL2TM:function(a,d,b,c){return this.changeXY(this.GP2TM(d,a,this.m_AB,this.m_FB,this.m_x0,this.m_y0,this.m_OKKTM,c,b+10.405/3600))},convertBESSEL2KTM:function(a,b){return this.changeXY(this.GP2TM(b,a,this.m_AB,this.m_FB,this.m_x1,this.m_y1,this.m_OKGTM,this.BASE_KTM_LAT,this.BASE_KTM_LON))},convertBESSEL2CONG:function(a,c){var b=new Array();b=this.GP2TM(c,a,this.m_AB,this.m_FB,this.m_x0,this.m_y0,this.m_OKKTM,this.BASE_TM_LAT,this.BASE_TM_LON+10.405/3600);b=this.changeXY(b);return this.shiftIsland(b[0],b[1],true)},convertBESSEL2BUTM:function(c,d,a,b){return this.changeXY(this.GP2TM(d,c,this.m_AB,this.m_FB,this.m_ux0,this.m_uy0,this.m_OKUTM,b,a))},convertBESSEL2BUTMK:function(a,b){return this.changeXY(this.GP2TM(b,a,this.m_AB,this.m_FB,this.m_ukx0,this.m_uky0,this.m_OKUTM,this.BASE_UTMK_LAT,this.BASE_UTMK_LON+10.405/3600))},convertBESSEL2WGS:function(a,c){var b=new Array();this.setParameter(this.m_TX,this.m_TY,this.m_TZ,this.m_TOMEGA,this.m_TPHI,this.m_TKAPPA,this.m_TS,this.m_TMODE);b=this.GP2WGP(c,a,0,this.m_AB,this.m_FB);return this.changeXY(b)},convertWGS2UTM:function(c,d,a,b){this.setParameter(this.m_TX,this.m_TY,this.m_TZ,this.m_TOMEGA,this.m_TPHI,this.m_TKAPPA,this.m_TS,this.m_TMODE);return this.changeXY(this.GP2TM(d,c,this.m_AW,this.m_FW,this.m_ux0,this.m_uy0,this.m_OKUTM,b,a))},convertWGS2BESSEL:function(a,c){var b=new Array();this.setParameter(this.m_TX,this.m_TY,this.m_TZ,this.m_TOMEGA,this.m_TPHI,this.m_TKAPPA,this.m_TS,this.m_TMODE);b=this.WGP2GP(c,a,0,this.m_AB,this.m_FB);return this.changeXY(b)},convertWGS2WTM:function(a,d,b,c){return this.changeXY(this.GP2TM(d,a,this.m_AW,this.m_FW,this.m_x0,this.m_y0,this.m_OKKTM,c,b))},convertWGS2WKTM:function(a,b){return this.changeXY(this.GP2TM(b,a,this.m_AW,this.m_FW,this.m_x1,this.m_y1,this.m_OKGTM,this.BASE_KTM_LAT,this.BASE_KTM_LON))},convertWGS2WCONG:function(a,c){var b=new Array();b=this.GP2TM(c,a,this.m_AW,this.m_FW,this.m_x0,this.m_y0,this.m_OKKTM,this.BASE_TM_LAT,this.BASE_TM_LON);b=this.changeXY(b);b[0]=Math.round(b[0]*2.5);b[1]=Math.round(b[1]*2.5);return b},convertWGS2UTMK:function(a,b){this.setParameter(this.m_TX,this.m_TY,this.m_TZ,this.m_TOMEGA,this.m_TPHI,this.m_TKAPPA,this.m_TS,this.m_TMODE);return this.changeXY(this.GP2TM(b,a,this.m_AW,this.m_FW,this.m_ukx0,this.m_uky0,this.m_OKUTM,this.BASE_UTMK_LAT,this.BASE_UTMK_LON))},convertTM2BESSEL:function(b,a,c,d){return this.changeXY(this.TM2GP(a,b,this.m_AB,this.m_FB,this.m_x0,this.m_y0,this.m_OKKTM,d,c+10.405/3600))},convertUTM2WGS:function(d,c,a,b){this.setParameter(this.m_TX,this.m_TY,this.m_TZ,this.m_TOMEGA,this.m_TPHI,this.m_TKAPPA,this.m_TS,this.m_TMODE);return this.changeXY(this.TM2GP(c,d,this.m_AW,this.m_FW,this.m_ux0,this.m_uy0,this.m_OKUTM,b,a))},convertUTMK2WGS:function(b,a){this.setParameter(this.m_TX,this.m_TY,this.m_TZ,this.m_TOMEGA,this.m_TPHI,this.m_TKAPPA,this.m_TS,this.m_TMODE);return this.changeXY(this.TM2GP(a,b,this.m_AW,this.m_FW,this.m_ukx0,this.m_uky0,this.m_OKUTM,this.BASE_UTMK_LAT,this.BASE_UTMK_LON))},convertKTM2BESSEL:function(b,a){return this.changeXY(this.TM2GP(a,b,this.m_AB,this.m_FB,this.m_x1,this.m_y1,this.m_OKGTM,this.BASE_KTM_LAT,this.BASE_KTM_LON))},convertBUTM2BESSEL:function(d,c,a,b){return this.changeXY(this.TM2GP(c,d,this.m_AB,this.m_FB,this.m_ux0,this.m_uy0,this.m_OKUTM,b,a))},convertBUTMK2BESSEL:function(b,a){return this.changeXY(this.TM2GP(a,b,this.m_AB,this.m_FB,this.m_ukx0,this.m_uky0,this.m_OKUTM,this.BASE_UTMK_LAT,this.BASE_UTMK_LON+10.405/3600))},convertCONG2BESSEL:function(b,a){var c=new Array();c=this.shiftIsland(b,a,false);return this.changeXY(this.TM2GP(c[1],c[0],this.m_AB,this.m_FB,this.m_x0,this.m_y0,this.m_OKKTM,this.BASE_TM_LAT,this.BASE_TM_LON+10.405/3600))},convertWTM2WGS:function(b,a,c,d){return this.changeXY(this.TM2GP(a,b,this.m_AW,this.m_FW,this.m_x0,this.m_y0,this.m_OKKTM,d,c))},convertWKTM2WGS:function(b,a){return this.changeXY(this.TM2GP(a,b,this.m_AW,this.m_FW,this.m_x1,this.m_y1,this.m_OKGTM,this.BASE_KTM_LAT,this.BASE_KTM_LON))},convertWCONG2WGS:function(b,a){var c=new Array();c[0]=b/2.5;c[1]=a/2.5;return this.changeXY(this.TM2GP(c[1],c[0],this.m_AW,this.m_FW,this.m_x0,this.m_y0,this.m_OKKTM,this.BASE_TM_LAT,this.BASE_TM_LON))},changeXY:function(a){this.tmp=a[0];a[0]=a[1];a[1]=this.tmp;return a},shiftIsland:function(e,d,c){var b=0,a=0;var g=new Object();if(c){for(var f=0;f<this.rectArray1.length;f++){if(((e-this.rectArray1[f].x)>=0)&&((e-this.rectArray1[f].x)<=this.rectArray1[f].w)&&((d-this.rectArray1[f].y)>=0)&&((d-this.rectArray1[f].y)<=this.rectArray1[f].h)){b+=this.deltaValue1[f][0];a+=this.deltaValue1[f][1];break}}g[0]=parseInt((e+b)*2.5+0.5);g[1]=parseInt((d+a)*2.5+0.5)}else{g[0]=e/2.5;g[1]=d/2.5;for(var f=0;f<this.rectArray2.length;f++){if(((g[0]-this.rectArray2[f].x)>=0)&&((g[0]-this.rectArray2[f].x)<=this.rectArray2[f].w)&&((g[1]-this.rectArray2[f].y)>=0)&&((g[1]-this.rectArray2[f].y)<=this.rectArray2[f].h)){g[0]+=this.deltaValue2[f][0];g[1]+=this.deltaValue2[f][1];break}}}return g},setParameter:function(i,h,g,f,d,c,a,b){var e=0;e=Math.atan(1)/45;this.m_dx=i;this.m_dy=h;this.m_dz=g;this.m_omega=f/3600*e;this.m_phi=d/3600*e;this.m_kappa=c/3600*e;this.m_ds=a*0.000001;this.m_imode=b},TransMolod:function(d,a,c){var b=new Array(3);b[0]=d+(1+this.m_ds)*(this.m_kappa*a-this.m_phi*c)+this.m_dx;b[1]=a+(1+this.m_ds)*(-this.m_kappa*d+this.m_omega*c)+this.m_dy;b[2]=c+(1+this.m_ds)*(this.m_phi*d-this.m_omega*a)+this.m_dz;return b},InverseMolod:function(g,a,c){var b=0,d=0,f=0;b=(g-this.m_dx)*(1+this.m_ds);d=(a-this.m_dy)*(1+this.m_ds);f=(c-this.m_dz)*(1+this.m_ds);var e=new Array(3);e[0]=1/(1+this.m_ds)*(b-this.m_kappa*d+this.m_phi*f);e[1]=1/(1+this.m_ds)*(this.m_kappa*b+d-this.m_omega*f);e[2]=1/(1+this.m_ds)*(-this.m_phi*b+this.m_omega*d+f);return e},TransBursa:function(d,a,c){var b=new Array(3);b[0]=(1+this.m_ds)*(d+this.m_kappa*a-this.m_phi*c)+this.m_dx;b[1]=(1+this.m_ds)*(-this.m_kappa*d+a+this.m_omega*c)+this.m_dy;b[2]=(1+this.m_ds)*(this.m_phi*d-this.m_omega*a+c)+this.m_dz;return b},InverseBursa:function(g,a,c){var b=0,d=0,f=0;b=g-this.m_dx;d=a-this.m_dy;f=c-this.m_dz;var e=new Array(3);e[0]=1/(1+this.m_ds)*(b-this.m_kappa*d+this.m_phi*f);e[1]=1/(1+this.m_ds)*(this.m_kappa*b+d-this.m_omega*f);e[2]=1/(1+this.m_ds)*(-this.m_phi*b+this.m_omega*d+f);return e},WGP2GP:function(i,g,b,c,e){var d=new Array(3);d=this.WGP2WCTR(i,g,b);if(this.m_imode==1){d=this.TransMolod(d[0],d[1],d[2])}else{d=this.TransBursa(d[0],d[1],d[2])}var h=new Array(2);h=this.CTR2GP(d[0],d[1],d[2],c,e);h[0]=h[0]+0/3600;h[1]=h[1]+0/3600;return h},WGP2WCTR:function(c,b,a){return this.GP2CTR(c,b,a,this.m_AW,this.m_FW)},WCTR2WGP:function(a,c,b){return this.CTR2GP(a,c,b,this.m_AW,this.m_FW)},GP2WGP:function(h,g,d,b,e){var c=new Array(3);c=this.GP2CTR(h,g,d,b,e);if(this.m_imode==1){c=this.InverseMolod(c[0],c[1],c[2])}else{c=this.InverseBursa(c[0],c[1],c[2])}return this.WCTR2WGP(c[0],c[1],c[2])},GP2CTR:function(o,c,i,q,g){var l=new Array(3);var p=0,k=0,s=0,e=0,m=0,r=0,d=0,j=0;j=g;if(j>1){j=1/j}p=Math.atan(1)/45;k=o*p;s=c*p;e=1/j;m=q*(e-1)/e;r=(Math.pow(q,2)-Math.pow(m,2))/Math.pow(q,2);d=q/Math.sqrt(1-r*Math.pow(Math.sin(k),2));l[0]=(d+i)*Math.cos(k)*Math.cos(s);l[1]=(d+i)*Math.cos(k)*Math.sin(s);l[2]=((Math.pow(m,2)/Math.pow(q,2))*d+i)*Math.sin(k);return l},CTR2GP:function(k,j,g,C,r){var v=0,c=0,u=0,m=0,e=0,A=0,B=0,q=0;var o=0,l=0,w=0,t=0;w=r;if(w>1){w=1/w}v=Math.atan(1)/45;e=1/w;A=C*(e-1)/e;B=(Math.pow(C,2)-Math.pow(A,2))/Math.pow(C,2);m=Math.atan(j/k);o=Math.sqrt(k*k+j*j);q=C;var s=0;do{s=s+1;l=Math.pow(Math.pow(A,2)/Math.pow(C,2)*q+t,2)-Math.pow(g,2);l=g/Math.sqrt(l);u=Math.atan(l);if(Math.abs(u-c)<1e-18){break}q=C/Math.sqrt(1-B*Math.pow(Math.sin(u),2));t=o/Math.cos(u)-q;c=u;if(s>30){break}}while(true);var d=new Array(2);d[0]=u/v;d[1]=m/v;if(k<0){d[1]=180+d[1]}if(d[1]<0){d[1]=360+d[1]}return d},GP2TM:function(o,P,aa,l,q,d,I,n,k){var m=0,V=0,K=0,y=0,W=0;var H=0,r=0,L=0,Z=0,R=0,g=0,ab=0;var i=0,S=0,v=0,j=0,U=0;var M=0,O=0,Y=0,N=0,u=0,p=0,X=0,T=0,Q=0,J=0;var G=0,F=0,E=0,D=0,C=0,B=0,A=0,x=0,w=0;var h=n;var e=k;H=d;W=l;if(W>1){W=1/W}r=Math.atan(1)/45;m=o*r;V=P*r;K=h*r;y=e*r;L=1/W;Z=aa*(L-1)/L;R=(Math.pow(aa,2)-Math.pow(Z,2))/Math.pow(aa,2);g=(Math.pow(aa,2)-Math.pow(Z,2))/Math.pow(Z,2);ab=(aa-Z)/(aa+Z);i=aa*(1-ab+5*(Math.pow(ab,2)-Math.pow(ab,3))/4+81*(Math.pow(ab,4)-Math.pow(ab,5))/64);S=3*aa*(ab-Math.pow(ab,2)+7*(Math.pow(ab,3)-Math.pow(ab,4))/8+55*Math.pow(ab,5)/64)/2;v=15*aa*(Math.pow(ab,2)-Math.pow(ab,3)+3*(Math.pow(ab,4)-Math.pow(ab,5))/4)/16;j=35*aa*(Math.pow(ab,3)-Math.pow(ab,4)+11*Math.pow(ab,5)/16)/48;U=315*aa*(Math.pow(ab,4)-Math.pow(ab,5))/512;M=V-y;T=i*K-S*Math.sin(2*K)+v*Math.sin(4*K)-j*Math.sin(6*K)+U*Math.sin(8*K);Q=T*I;O=Math.sin(m);Y=Math.cos(m);N=O/Y;u=g*Math.pow(Y,2);p=aa/Math.sqrt(1-R*Math.pow(Math.sin(m),2));X=i*m-S*Math.sin(2*m)+v*Math.sin(4*m)-j*Math.sin(6*m)+U*Math.sin(8*m);var z=new Array(2);G=X*I;F=p*O*Y*I/2;E=p*O*Math.pow(Y,3)*I*(5-Math.pow(N,2)+9*u+4*Math.pow(u,2))/24;D=p*O*Math.pow(Y,5)*I*(61-58*Math.pow(N,2)+Math.pow(N,4)+270*u-330*Math.pow(N,2)*u+445*Math.pow(u,2)+324*Math.pow(u,3)-680*Math.pow(N,2)*Math.pow(u,2)+88*Math.pow(u,4)-600*Math.pow(N,2)*Math.pow(u,3)-192*Math.pow(N,2)*Math.pow(u,4))/720;C=p*O*Math.pow(Y,7)*I*(1385-3111*Math.pow(N,2)+543*Math.pow(N,4)-Math.pow(N,6))/40320;J=G+Math.pow(M,2)*F+Math.pow(M,4)*E+Math.pow(M,6)*D+Math.pow(M,8)*C;z[0]=J-Q+q;B=p*Y*I;A=p*Math.pow(Y,3)*I*(1-Math.pow(N,2)+u)/6;x=p*Math.pow(Y,5)*I*(5-18*Math.pow(N,2)+Math.pow(N,4)+14*u-58*Math.pow(N,2)*u+13*Math.pow(u,2)+4*Math.pow(u,3)-64*Math.pow(N,2)*Math.pow(u,2)-25*Math.pow(N,2)*Math.pow(u,3))/120;w=p*Math.pow(Y,7)*I*(61-479*Math.pow(N,2)+179*Math.pow(N,4)-Math.pow(N,6))/5040;z[1]=H+M*B+Math.pow(M,3)*A+Math.pow(M,5)*x+Math.pow(M,7)*w;return z},TM2GP:function(J,D,ab,r,z,e,I,v,q){var u=0,W=0,M=0,F=0,X=0;var H=0,A=0,N=0,aa=0,R=0,n=0,ac=0;var o=0,S=0,E=0,p=0,U=0;var C=0,P=0,Z=0,O=0,B=0,y=0,Y=0,T=0,Q=0,L=0;var m=0,l=0,k=0,j=0,h=0,g=0,d=0,ad=0;var x=0,w=0,K=0;X=r;if(X>1){X=1/X}H=e;A=Math.atan(1)/45;M=v*A;F=q*A;N=1/X;aa=ab*(N-1)/N;R=(Math.pow(ab,2)-Math.pow(aa,2))/Math.pow(ab,2);n=(Math.pow(ab,2)-Math.pow(aa,2))/Math.pow(aa,2);ac=(ab-aa)/(ab+aa);o=ab*(1-ac+5*(Math.pow(ac,2)-Math.pow(ac,3))/4+81*(Math.pow(ac,4)-Math.pow(ac,5))/64);S=3*ab*(ac-Math.pow(ac,2)+7*(Math.pow(ac,3)-Math.pow(ac,4))/8+55*Math.pow(ac,5)/64)/2;E=15*ab*(Math.pow(ac,2)-Math.pow(ac,3)+3*(Math.pow(ac,4)-Math.pow(ac,5))/4)/16;p=35*ab*(Math.pow(ac,3)-Math.pow(ac,4)+11*Math.pow(ac,5)/16)/48;U=315*ab*(Math.pow(ac,4)-Math.pow(ac,5))/512;T=o*M-S*Math.sin(2*M)+E*Math.sin(4*M)-p*Math.sin(6*M)+U*Math.sin(8*M);Q=T*I;L=J+Q-z;Y=L/I;w=ab*(1-R)/Math.pow(Math.sqrt(1-R*Math.pow(Math.sin(0),2)),3);K=Y/w;for(var V=1;V<=5;V++){m=o*K-S*Math.sin(2*K)+E*Math.sin(4*K)-p*Math.sin(6*K)+U*Math.sin(8*K);w=ab*(1-R)/Math.pow(Math.sqrt(1-R*Math.pow(Math.sin(K),2)),3);K=K+(Y-m)/w}w=ab*(1-R)/Math.pow(Math.sqrt(1-R*Math.pow(Math.sin(K),2)),3);y=ab/Math.sqrt(1-R*Math.pow(Math.sin(K),2));P=Math.sin(K);Z=Math.cos(K);O=P/Z;B=n*Math.pow(Z,2);x=D-H;m=O/(2*w*y*Math.pow(I,2));l=O*(5+3*Math.pow(O,2)+B-4*Math.pow(B,2)-9*Math.pow(O,2)*B)/(24*w*Math.pow(y,3)*Math.pow(I,4));k=O*(61+90*Math.pow(O,2)+46*B+45*Math.pow(O,4)-252*Math.pow(O,2)*B-3*Math.pow(B,2)+100*Math.pow(B,3)-66*Math.pow(O,2)*Math.pow(B,2)-90*Math.pow(O,4)*B+88*Math.pow(B,4)+225*Math.pow(O,4)*Math.pow(B,2)+84*Math.pow(O,2)*Math.pow(B,3)-192*Math.pow(O,2)*Math.pow(B,4))/(720*w*Math.pow(y,5)*Math.pow(I,6));j=O*(1385+3633*Math.pow(O,2)+4095*Math.pow(O,4)+1575*Math.pow(O,6))/(40320*w*Math.pow(y,7)*Math.pow(I,8));u=K-Math.pow(x,2)*m+Math.pow(x,4)*l-Math.pow(x,6)*k+Math.pow(x,8)*j;h=1/(y*Z*I);g=(1+2*Math.pow(O,2)+B)/(6*Math.pow(y,3)*Z*Math.pow(I,3));d=(5+6*B+28*Math.pow(O,2)-3*Math.pow(B,2)+8*Math.pow(O,2)*B+24*Math.pow(O,4)-4*Math.pow(B,3)+4*Math.pow(O,2)*Math.pow(B,2)+24*Math.pow(O,2)*Math.pow(B,3))/(120*Math.pow(y,5)*Z*Math.pow(I,5));ad=(61+662*Math.pow(O,2)+1320*Math.pow(O,4)+720*Math.pow(O,6))/(5040*Math.pow(y,7)*Z*Math.pow(I,7));C=x*h-Math.pow(x,3)*g+Math.pow(x,5)*d-Math.pow(x,7)*ad;W=F+C;var G=new Array(2);G[0]=u/A;G[1]=W/A;return G}};